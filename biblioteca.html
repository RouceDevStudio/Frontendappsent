<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UpGames - LibrerÃ­a Digital</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://unpkg.com">
    <link rel="stylesheet" href="./styles.css">
</head>
<body>
    <!-- PRELOADER OPTIMIZADO -->
    <div id="upgames-preloader">
        <div class="pl-bg-glow"></div>
        <div class="pl-center">
            <div class="pl-logo-wrap">
                <div class="pl-logo-ring"></div>
                <div class="pl-logo-ring pl-ring-2"></div>
                <div class="pl-logo-text">
                    <span class="pl-up">UP</span><span class="pl-gm">GAMES</span>
                </div>
            </div>
            <div class="pl-particles">
                <span class="pl-dot" style="--x:20%;--y:30%;--d:1.2s"></span>
                <span class="pl-dot" style="--x:80%;--y:20%;--d:0.8s"></span>
                <span class="pl-dot" style="--x:15%;--y:70%;--d:1.6s"></span>
                <span class="pl-dot" style="--x:75%;--y:65%;--d:0.5s"></span>
                <span class="pl-dot" style="--x:50%;--y:85%;--d:1.0s"></span>
                <span class="pl-dot pl-dot-blue" style="--x:35%;--y:15%;--d:0.7s"></span>
                <span class="pl-dot pl-dot-blue" style="--x:88%;--y:50%;--d:1.4s"></span>
            </div>
            <div class="pl-bar-track">
                <div class="pl-bar-fill" id="pl-bar"></div>
            </div>
            <p class="pl-tagline" id="pl-tagline">LA NUBE DE CONTENIDO</p>
        </div>
    </div>

    <!-- LOADING STATE -->
    <div id="loading-state" style="display:none;
        position: fixed; top: 50%; left: 50%;
        transform: translate(-50%, -50%);
        text-align: center; z-index: 9999;">
        <div style="width:50px;height:50px;border:3px solid #222;
            border-top-color:#5EFF43;border-radius:50%;
            animation:spin 0.9s linear infinite;margin:0 auto 16px;"></div>
        <p style="color:#5EFF43;font-size:0.8rem;font-weight:700;letter-spacing:2px;">
            CARGANDO NUBE...
        </p>
    </div>

    <style>
        @keyframes spin { to { transform: rotate(360deg); } }

        /* â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” PRELOADER OPTIMIZADO â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” */
        #upgames-preloader {
            position: fixed;
            inset: 0;
            background: #080808;
            z-index: 99999;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            transition: opacity 0.6s ease, visibility 0.6s ease;
        }
        #upgames-preloader.ocultar {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
        }

        .pl-bg-glow {
            position: absolute;
            width: 600px; height: 600px;
            background: radial-gradient(circle, rgba(94,255,67,0.06) 0%, transparent 70%);
            border-radius: 50%;
            animation: plGlowPulse 3s ease-in-out infinite;
            pointer-events: none;
        }
        @keyframes plGlowPulse {
            0%, 100% { transform: scale(1);   opacity: 0.6; }
            50%       { transform: scale(1.15); opacity: 1;   }
        }

        .pl-center {
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 36px;
        }

        .pl-logo-wrap {
            position: relative;
            width: 140px; height: 140px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .pl-logo-ring {
            position: absolute;
            inset: 0;
            border-radius: 50%;
            border: 1.5px solid transparent;
            border-top-color: #5EFF43;
            border-right-color: rgba(94,255,67,0.2);
            animation: plSpin 2.2s linear infinite;
        }
        .pl-ring-2 {
            inset: 14px;
            border-top-color: transparent;
            border-bottom-color: #00f2ff;
            border-left-color: rgba(0,242,255,0.2);
            animation: plSpinRev 3s linear infinite;
        }
        @keyframes plSpin    { to { transform: rotate(360deg);  } }
        @keyframes plSpinRev { to { transform: rotate(-360deg); } }

        .pl-logo-text {
            font-size: 1.6rem;
            font-weight: 900;
            letter-spacing: 2px;
            animation: plLogoPulse 2s ease-in-out infinite;
            user-select: none;
        }
        .pl-up { color: #5EFF43; text-shadow: 0 0 18px rgba(94,255,67,0.7); }
        .pl-gm { color: #fff; }
        @keyframes plLogoPulse {
            0%, 100% { opacity: 1;    transform: scale(1);    }
            50%       { opacity: 0.85; transform: scale(0.97); }
        }

        .pl-particles { position: fixed; inset: 0; pointer-events: none; }
        .pl-dot {
            position: absolute;
            left: var(--x);
            top: var(--y);
            width: 4px; height: 4px;
            background: rgba(94,255,67,0.5);
            border-radius: 50%;
            animation: plFloat var(--d, 1s) ease-in-out infinite alternate;
            box-shadow: 0 0 6px rgba(94,255,67,0.4);
        }
        .pl-dot-blue {
            background: rgba(0,242,255,0.5);
            box-shadow: 0 0 6px rgba(0,242,255,0.4);
        }
        @keyframes plFloat {
            from { transform: translateY(0px)  scale(1);    opacity: 0.4; }
            to   { transform: translateY(-14px) scale(1.3); opacity: 1;   }
        }

        .pl-bar-track {
            width: 200px; height: 2px;
            background: #1a1a1a;
            border-radius: 10px;
            overflow: hidden;
        }
        .pl-bar-fill {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #5EFF43, #00f2ff);
            border-radius: 10px;
            transition: width 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 0 10px rgba(94,255,67,0.6);
        }

        .pl-tagline {
            color: #2a2a2a;
            font-size: 0.65rem;
            font-weight: 700;
            letter-spacing: 4px;
            text-transform: uppercase;
            animation: plTagFade 2s ease-in-out infinite alternate;
        }
        @keyframes plTagFade {
            from { color: #222; }
            to   { color: #444; }
        }
    </style>

    <script>
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // LÃ“GICA DEL PRELOADER OPTIMIZADO
    // Progresa rÃ¡pido hasta 70% y espera al backend
    // Si no responde en 3 segundos, cierra igual
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    (function initPreloader() {
        const preloader = document.getElementById('upgames-preloader');
        const bar       = document.getElementById('pl-bar');
        const tagline   = document.getElementById('pl-tagline');

        let cerrado = false;
        let backendCargado = false;

        // Avance rÃ¡pido hasta 70% en 600ms
        const etapas = [
            { pct: 30, delay: 200  },
            { pct: 50, delay: 400  },
            { pct: 70, delay: 600 }
        ];

        function avanzarBarra() {
            let i = 0;
            function siguiente() {
                if (i >= etapas.length || cerrado) return;
                bar.style.width = etapas[i].pct + '%';
                i++;
                if (i < etapas.length) {
                    setTimeout(siguiente, etapas[i].delay - (etapas[i-1]?.delay || 0));
                }
            }
            siguiente();
        }

        function cerrarPreloader() {
            if (cerrado) return;
            cerrado = true;
            bar.style.width = '100%';
            setTimeout(() => {
                preloader.classList.add('ocultar');
            }, 300);
        }

        // Iniciar progreso
        avanzarBarra();

        // Escuchar cuando el backend estÃ© listo
        window.addEventListener('backendReady', () => {
            backendCargado = true;
            cerrarPreloader();
        });

        // Timeout: si backend no responde en 3s, cerrar igual
        setTimeout(() => {
            if (!backendCargado) {
                console.warn('Backend tardÃ³ mÃ¡s de 3s, cerrando preloader');
                cerrarPreloader();
            }
        }, 3000);
    })();
    </script>

    <!-- HEADER MEJORADO -->
    <header>
        <div class="buscador-wrapper">
            <ion-icon name="search-outline" class="buscador-icon"></ion-icon>
            <input type="text" id="buscador" placeholder="Buscar...">
        </div>
        
        <div class="header-right-actions">
            <button class="UpIcon" onclick="window.location.href='./perfil.html'" title="Subir archivo">
                <ion-icon name="cloud-upload"></ion-icon>
            </button>
            
            <a class="reportButton" id="reportButton" href="#" onclick="handleMail(event)">
                <ion-icon name="information-circle"></ion-icon>
            </a>
        </div>
    </header>

    <!-- OVERLAY PARA MODAL -->
    <div class="expandida-overlay" id="overlay"></div>

    <!-- CONTENEDOR PRINCIPAL -->
    <div id="output"></div>

    <!-- MODAL DE TÃ‰RMINOS -->
    <div id="modal-terminos" class="custom-modal-wrapper">
        <div class="custom-modal-card">
            <div class="custom-modal-header">
                <span class="emoji-header">ğŸš€</span>
                <h1>BIENVENIDO A UPGAMES</h1>
                <p style="color: #888; font-size: 0.8rem; margin-top: 5px;">La evoluciÃ³n de las librerÃ­as digitales</p>
            </div>
            
            <div class="custom-modal-body">
                <div class="benefits-section">
                    <h3>ğŸ’ BENEFICIOS EXCLUSIVOS</h3>
                    <ul class="benefits-list">
                        <li><strong>MonetizaciÃ³n Real:</strong> Gana $1.00 USD por cada 1,000 descargas de tus aportes.</li>
                        <li><strong>Lanzadera Indie:</strong> Publica tus propios juegos, apps o mods con visibilidad global gratuita.</li>
                        <li><strong>Seguridad 24/7:</strong> Navega tranquilo gracias a nuestros bots que filtran malware y contenido +18.</li>
                        <li><strong>Comunidad Activa:</strong> Indexa y encuentra metadatos de software que no hallarÃ¡s en tiendas oficiales.</li>
                        <li><strong>Estatus de Trusted Indexer:</strong> Sube de nivel y obtÃ©n prioridad en el feed principal.</li>
                        <li><strong>NEXUS IA Integrada:</strong> Accede a nuestra inteligencia artificial exclusiva para encontrar contenido, resolver dudas y recibir recomendaciones personalizadas â€” sin salir de la plataforma.</li>
                    </ul>
                </div>

                <hr style="border: 0; border-top: 1px solid #333; margin: 20px 0;">

                <h3>âš–ï¸ BREVE RESUMEN LEGAL</h3>
                <p>Para mantener este ecosistema seguro y gratuito, operamos bajo estas reglas:</p>
                <ul class="legal-summary">
                    <li><strong>IntermediaciÃ³n:</strong> Somos una librerÃ­a de metadatos; no almacenamos archivos.</li>
                    <li><strong>Responsabilidad:</strong> El contenido es responsabilidad de quien lo publica y lo descarga.</li>
                    <li><strong>Filtros Activos:</strong> Prohibido el contenido ilegal, piraterÃ­a o material sensible.</li>
                    <li><strong>Neutralidad:</strong> No podemos revisar miles de links manualmente, pero atendemos reportes en 24-72h.</li>
                </ul>
            </div>

            <div class="custom-modal-footer">
                <a href="./terminos&condiciones.html" class="legal-link">Conoce nuestro contrato legal completo (v.2026.C)</a>
                
                <div class="button-group">
                    <button id="btn-aceptar-terminos" class="btn-confirm">âœ“ ACEPTAR Y EMPEZAR A GANAR</button>
                    <button onclick="window.location.href='https://google.com'" class="btn-cancel">RECHAZAR</button>
                </div>
            </div>
        </div>
    </div>

    <style>
        :root {
            --neon-green: #39ff14;
            --neon-blue: #00f2ff;
            --glass-bg: #0d0d0d;
            --text-gray: #bbb;
        }

        .custom-modal-wrapper {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(15px);
            z-index: 10000;
            padding: 15px;
            font-family: 'Segoe UI', Roboto, sans-serif;
        }

        .custom-modal-card {
            position: relative;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--glass-bg);
            border: 1px solid #222;
            border-radius: 20px;
            width: 100%;
            max-width: 480px;
            max-height: 90vh;
            display: flex;
            flex-direction: column;
            box-shadow: 0 0 50px rgba(0, 242, 255, 0.15);
        }

        .custom-modal-header {
            padding: 25px 20px 15px;
            text-align: center;
            border-bottom: 1px solid #222;
        }

        .emoji-header { font-size: 2.5rem; filter: drop-shadow(0 0 10px var(--neon-blue)); }

        .custom-modal-header h1 {
            color: #fff;
            font-size: 1.4rem;
            margin: 10px 0 0;
            letter-spacing: 2px;
            text-transform: uppercase;
        }

        .custom-modal-body {
            padding: 25px;
            overflow-y: auto;
            color: var(--text-gray);
            font-size: 0.95rem;
            line-height: 1.5;
        }

        .custom-modal-body h3 {
            color: var(--neon-blue);
            font-size: 0.9rem;
            margin-bottom: 12px;
            letter-spacing: 1px;
        }

        .benefits-list, .legal-summary {
            padding-left: 15px;
            list-style: none;
        }

        .benefits-list li::before {
            content: "âœ¦";
            color: var(--neon-green);
            margin-right: 10px;
            font-weight: bold;
        }

        .legal-summary li::before {
            content: "â€¢";
            color: #ff003c;
            margin-right: 10px;
        }

        .benefits-list li, .legal-summary li {
            margin-bottom: 10px;
        }

        .custom-modal-footer {
            padding: 20px;
            background: rgba(0,0,0,0.4);
            border-top: 1px solid #222;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .legal-link {
            color: var(--neon-blue);
            font-size: 0.8rem;
            text-align: center;
            text-decoration: none;
            border-bottom: 1px solid transparent;
            transition: 0.3s;
        }

        .legal-link:hover { border-bottom: 1px solid var(--neon-blue); }

        .button-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .btn-confirm {
            background: var(--neon-green);
            color: #000;
            border: none;
            padding: 16px;
            border-radius: 10px;
            font-weight: 900;
            cursor: pointer;
            width: 100%;
            text-transform: uppercase;
            transition: 0.3s;
        }

        .btn-confirm:hover {
            background: #fff;
            box-shadow: 0 0 20px var(--neon-green);
        }

        .btn-cancel {
            background: transparent;
            color: #666;
            border: 1px solid #333;
            padding: 10px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 0.8rem;
        }

        @media (min-width: 600px) {
            .button-group { flex-direction: row; }
            .btn-confirm { flex: 2; }
            .btn-cancel { flex: 1; }
        }

        .custom-modal-body::-webkit-scrollbar { width: 5px; }
        .custom-modal-body::-webkit-scrollbar-thumb { background: #333; border-radius: 10px; }
    </style>

    <script>
        (function() {
            const modal = document.getElementById('modal-terminos');
            const btnAceptar = document.getElementById('btn-aceptar-terminos');
            const modalBody = modal.querySelector('.custom-modal-body');

            // Solo mostrar si es la primera vez (nunca completÃ³ el onboarding)
            const esPrimeraVez = localStorage.getItem("upgames_onboarding_done") !== "1";

            if (esPrimeraVez) {
                modal.style.display = 'block';
                document.body.style.overflow = 'hidden';

                // Bloquear botÃ³n hasta que el usuario haga scroll hasta el fondo
                btnAceptar.disabled = true;
                btnAceptar.style.opacity = '0.4';
                btnAceptar.style.cursor = 'not-allowed';
                btnAceptar.textContent = 'ğŸ“– DesplÃ¡zate para leer los tÃ©rminos...';

                let leido = false;
                modalBody.addEventListener('scroll', function() {
                    if (!leido) {
                        const scrolled = modalBody.scrollTop + modalBody.clientHeight;
                        const total = modalBody.scrollHeight;
                        if (scrolled >= total - 30) {
                            leido = true;
                            btnAceptar.disabled = false;
                            btnAceptar.style.opacity = '1';
                            btnAceptar.style.cursor = 'pointer';
                            btnAceptar.textContent = 'âœ“ ACEPTAR Y EMPEZAR A GANAR';
                        }
                    }
                });
            }

            btnAceptar.addEventListener('click', () => {
                if (btnAceptar.disabled) return;
                localStorage.setItem("upgames_terms_version", "2026.C");
                modal.style.display = 'none';
                document.body.style.overflow = 'auto';
                // Disparar tutorial solo la primera vez
                if (esPrimeraVez) {
                    setTimeout(() => {
                        if (typeof startBibliotecaTutorial === 'function') startBibliotecaTutorial();
                    }, 600);
                }
            });
        })();
    </script>

    <!-- IONICONS -->
    <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>

    <!-- SCRIPT PRINCIPAL -->
    <script src="./script.js"></script>
    
    <!-- FUNCIÃ“N DE SOPORTE -->
    <script>
        function handleMail(event) {
            event.preventDefault();
            const email = 'mr.m0onster@protonmail.com';
            const subject = encodeURIComponent('Soporte - UP GAMES');
            const body = encodeURIComponent('Hola, necesito ayuda con...\n\n[Describe tu problema aquÃ­]');
            window.location.href = `mailto:${email}?subject=${subject}&body=${body}`;
        }
    </script>
    
    
    
    <button id="nxFab" onclick="nxToggle()" aria-label="NEXUS AI">
  <div class="nxf-glow"></div>
  <div class="nxf-ring"></div>
  <div class="nxf-core">
    <svg viewBox="0 0 32 32" fill="none" class="nxf-eye">
      <path d="M16 2L30 16L16 30L2 16Z" stroke="currentColor" stroke-width=".9" opacity=".35"/>
      <path d="M16 7L25 16L16 25L7 16Z" stroke="currentColor" stroke-width=".7" opacity=".5"/>
      <ellipse cx="16" cy="16" rx="6.5" ry="4.2" stroke="currentColor" stroke-width="1.1"/>
      <circle cx="16" cy="16" r="2.2" fill="currentColor"/>
      <circle cx="16" cy="2"  r="1.1" fill="currentColor" opacity=".7"/>
      <circle cx="30" cy="16" r="1.1" fill="currentColor" opacity=".5"/>
      <circle cx="16" cy="30" r="1.1" fill="currentColor" opacity=".7"/>
      <circle cx="2"  cy="16" r="1.1" fill="currentColor" opacity=".5"/>
    </svg>
  </div>
</button>

<!-- â•â• PANEL â•â• -->
<div id="nxPanel">
  <!-- Esquinas decorativas (visibles en modo expandido) -->
  <div class="nx-corner-tr"></div>
  <div class="nx-corner-bl"></div>

  <!-- Header -->
  <div class="nx-header">
    <div class="nx-hl">
      <svg viewBox="0 0 22 22" fill="none" class="nx-logo-icon">
        <path d="M11 1L21 11L11 21L1 11Z" stroke="currentColor" stroke-width=".8" opacity=".3"/>
        <ellipse cx="11" cy="11" rx="4.5" ry="3" stroke="currentColor" stroke-width="1"/>
        <circle cx="11" cy="11" r="1.6" fill="currentColor"/>
      </svg>
      <span class="nx-title">NEXUS</span>
      <span class="nx-online-dot"></span>
    </div>
    <div class="nx-hr">
      <button class="nx-ibtn" id="nxExpandBtn" onclick="nxExpand()" title="Expandir">
        <svg viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="1.6">
          <path d="M1 5V1h4M9 1h4v4M13 9v4H9M5 13H1V9"/>
        </svg>
      </button>
      <button class="nx-ibtn nx-close" onclick="nxToggle()" title="Cerrar">
        <svg viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M2 2l10 10M12 2L2 12"/>
        </svg>
      </button>
    </div>
  </div>
  <div class="nx-sep"></div>

  <!-- iFrame -->
  <div class="nx-body">
    <iframe id="nxIframe" src="" data-src="https://backendbuscador.onrender.com"
      allow="microphone; clipboard-read; clipboard-write"
      title="NEXUS" loading="lazy">
    </iframe>

    <!-- Boot -->
    <div id="nxBoot" class="nx-boot">
      <svg viewBox="0 0 52 52" fill="none" class="nb-ico">
        <path d="M26 2L50 26L26 50L2 26Z" stroke="#c87941" stroke-width=".8" opacity=".3"/>
        <path d="M26 9L43 26L26 43L9 26Z" stroke="#c87941" stroke-width=".7" opacity=".5"/>
        <ellipse cx="26" cy="26" rx="9" ry="6" stroke="#c87941" stroke-width="1.2"/>
        <circle cx="26" cy="26" r="3" fill="#c87941"/>
      </svg>
      <p class="nb-lbl" id="nbLbl">INICIANDOâ€¦</p>
      <div class="nb-bar"><div class="nb-prog" id="nbProg"></div></div>
      <div class="nb-log" id="nbLog"></div>
    </div>
  </div>

  <!-- Footer -->
  <div class="nx-foot">
    <span><i class="nx-ft-dot"></i>NEXUS</span>
    <span id="nxClk">â”€â”€:â”€â”€</span>
  </div>
</div>

<!-- Overlay -->
<div id="nxOvr" onclick="nxToggle()"></div>

<!-- â•â•â•â•â•â•â•â•â•â• CSS â•â•â•â•â•â•â•â•â•â• -->
<style>
@import url('https://fonts.googleapis.com/css2?family=Syne:wght@700;800&family=Space+Mono&display=swap');

:root {
  /* Paleta NEXUS: dorado/naranja/cobre */
  --no:  #c87941;   /* naranja/cobre principal */
  --ng:  #e8a96a;   /* naranja claro            */
  --nc:  #00f2ff;   /* cyan (acento secundario) */
  --nd:  #07060a;   /* negro profundo           */
  --ns:  #0e0c12;   /* superficie               */
  --nb:  rgba(200,121,65,.2);  /* borde naranja tenue */

  --fab: 70px;      /* tamaÃ±o botÃ³n             */
  --bot: 74px;      /* distancia desde abajo    */
  --pw:  370px;
  --ph:  590px;
  --br:  12px;
  --ff1: 'Syne', sans-serif;
  --ff2: 'Space Mono', monospace;
}

/* â”€â”€ FAB â”€â”€ */
#nxFab {
  position: fixed;
  bottom: var(--bot);       /* mÃ¡s arriba */
  right: 20px;
  width: var(--fab);
  height: var(--fab);
  border-radius: 50%;
  background: var(--nd);
  border: none; padding: 0;
  cursor: pointer;
  z-index: 9990;
  display: flex; align-items: center; justify-content: center;
  outline: none;
  transition: transform .3s cubic-bezier(.34,1.56,.64,1);
}
#nxFab:hover { transform: scale(1.1); }
#nxFab.open  { transform: scale(.88) rotate(90deg); }

.nxf-glow {
  position: absolute; inset: -8px;
  border-radius: 50%;
  background: radial-gradient(circle, rgba(200,121,65,.18) 0%, transparent 70%);
  animation: nxGlowPulse 3s ease-in-out infinite;
  pointer-events: none;
}
@keyframes nxGlowPulse {
  0%,100% { opacity:.6; transform:scale(1); }
  50%     { opacity:1;  transform:scale(1.15); }
}

.nxf-ring {
  position: absolute; inset: 0;
  border-radius: 50%;
  border: 1.5px solid var(--no);
  box-shadow: 0 0 14px rgba(200,121,65,.35), inset 0 0 8px rgba(200,121,65,.08);
  animation: nxRingBreathe 2.8s ease-in-out infinite;
  pointer-events: none;
}
@keyframes nxRingBreathe {
  0%,100% { box-shadow: 0 0 10px rgba(200,121,65,.3), inset 0 0 6px rgba(200,121,65,.06); }
  50%     { box-shadow: 0 0 22px rgba(200,121,65,.6), inset 0 0 12px rgba(200,121,65,.12); }
}

.nxf-core {
  width: 50px; height: 50px;
  border-radius: 50%;
  background: radial-gradient(circle at 38% 36%, #1c1208, var(--nd) 68%);
  display: flex; align-items: center; justify-content: center;
  color: var(--no);
  position: relative; z-index: 1;
}
.nxf-eye {
  width: 28px; height: 28px;
  animation: nxEyePulse 4s ease-in-out infinite;
}
@keyframes nxEyePulse {
  0%,100% { color:var(--no); filter:drop-shadow(0 0 3px var(--no)); }
  50%     { color:var(--ng); filter:drop-shadow(0 0 6px var(--ng)); }
}

/* â”€â”€ PANEL â”€â”€ */
#nxPanel {
  position: fixed;
  bottom: calc(var(--fab) + var(--bot) + 10px);
  right: 20px;
  width: var(--pw);
  height: var(--ph);
  max-height: calc(100svh - 160px);
  background: var(--ns);
  border: 1px solid var(--nb);
  border-radius: var(--br);
  z-index: 9991;
  display: flex; flex-direction: column;
  overflow: hidden;
  transform: scale(.82) translateY(32px);
  transform-origin: bottom right;
  opacity: 0; pointer-events: none;
  transition:
    transform .38s cubic-bezier(.34,1.56,.64,1),
    opacity .28s ease;
  box-shadow:
    0 0 0 .5px rgba(200,121,65,.07),
    0 24px 70px rgba(0,0,0,.96),
    0 0 50px rgba(200,121,65,.05);
}
#nxPanel.open {
  transform: scale(1) translateY(0);
  opacity: 1; pointer-events: all;
}

/* EXPANDED â€” ventana cockpit con esquinas marcadas */
#nxPanel.expanded {
  top: 16px;
  left: 16px;
  right: 16px;
  bottom: 16px;
  width: auto;
  height: auto;
  max-height: none;
  border-radius: 6px;
  border: 1px solid rgba(200,121,65,.3);
  box-shadow:
    0 0 0 1px rgba(200,121,65,.06),
    0 0 60px rgba(200,121,65,.08),
    inset 0 0 80px rgba(0,0,0,.4),
    0 50px 100px rgba(0,0,0,.99);
}
/* Esquinas tipo HUD cuando estÃ¡ expandido */
#nxPanel.expanded::before,
#nxPanel.expanded::after {
  content: '';
  position: absolute;
  width: 20px; height: 20px;
  pointer-events: none;
  z-index: 20;
}
#nxPanel.expanded::before {
  top: -1px; left: -1px;
  border-top: 2px solid var(--no);
  border-left: 2px solid var(--no);
  border-radius: 6px 0 0 0;
}
#nxPanel.expanded::after {
  bottom: -1px; right: -1px;
  border-bottom: 2px solid var(--no);
  border-right: 2px solid var(--no);
  border-radius: 0 0 6px 0;
}
/* Esquinas opuestas via wrapper de esquinas */
#nxPanel.expanded .nx-corner-tr,
#nxPanel.expanded .nx-corner-bl {
  display: block;
}
.nx-corner-tr, .nx-corner-bl {
  display: none;
  position: absolute;
  width: 20px; height: 20px;
  pointer-events: none;
  z-index: 20;
}
.nx-corner-tr {
  top: -1px; right: -1px;
  border-top: 2px solid rgba(200,121,65,.5);
  border-right: 2px solid rgba(200,121,65,.5);
  border-radius: 0 6px 0 0;
}
.nx-corner-bl {
  bottom: -1px; left: -1px;
  border-bottom: 2px solid rgba(200,121,65,.5);
  border-left: 2px solid rgba(200,121,65,.5);
  border-radius: 0 0 0 6px;
}
/* Barra superior especial en modo expandido */
#nxPanel.expanded .nx-header {
  background: linear-gradient(180deg, rgba(200,121,65,.06) 0%, transparent 100%);
  border-bottom: 1px solid rgba(200,121,65,.12);
  padding: 11px 16px 9px;
}
#nxPanel.expanded .nx-sep { display: none; }
#nxPanel.expanded .nx-title {
  font-size: .9rem;
  letter-spacing: 5px;
}

/* â”€â”€ HEADER â”€â”€ */
.nx-header {
  display: flex; align-items: center; justify-content: space-between;
  padding: 9px 13px 7px;
  flex-shrink: 0;
}
.nx-hl { display: flex; align-items: center; gap: 7px; }
.nx-hr { display: flex; align-items: center; gap: 5px; }

.nx-logo-icon {
  width: 17px; height: 17px;
  color: var(--no);
  filter: drop-shadow(0 0 3px rgba(200,121,65,.5));
}
.nx-title {
  font-family: var(--ff1);
  font-weight: 800; font-size: .82rem;
  letter-spacing: 4px;
  color: var(--no);
  text-shadow: 0 0 10px rgba(200,121,65,.45);
}
.nx-online-dot {
  width: 5px; height: 5px;
  border-radius: 50%;
  background: #39ff14;
  box-shadow: 0 0 6px #39ff14;
  animation: nxBlink 1.8s step-end infinite;
  flex-shrink: 0;
}
@keyframes nxBlink { 0%,100%{opacity:1} 50%{opacity:.1} }

/* Header buttons */
.nx-ibtn {
  width: 26px; height: 26px;
  background: transparent;
  border: .5px solid rgba(200,121,65,.18);
  border-radius: 6px;
  cursor: pointer;
  display: flex; align-items: center; justify-content: center;
  color: rgba(200,121,65,.35);
  transition: all .2s;
}
.nx-ibtn svg { width: 11px; height: 11px; }
.nx-ibtn:hover { border-color: var(--no); color: var(--no); box-shadow: 0 0 8px rgba(200,121,65,.2); }
.nx-close:hover { border-color: #ff3355; color: #ff3355; box-shadow: 0 0 8px rgba(255,51,85,.2); }

/* Separador */
.nx-sep {
  height: .5px;
  margin: 0 13px;
  background: linear-gradient(90deg,
    transparent,
    rgba(200,121,65,.25) 30%,
    rgba(0,242,255,.12) 70%,
    transparent);
  flex-shrink: 0;
}

/* â”€â”€ BODY â”€â”€ */
.nx-body {
  flex: 1; position: relative; overflow: hidden;
  background: #060409;
}
#nxIframe {
  width: 100%; height: 100%;
  border: none; display: block;
  opacity: 0; transition: opacity .5s ease;
}
#nxIframe.loaded { opacity: 1; }

/* â”€â”€ BOOT â”€â”€ */
.nx-boot {
  position: absolute; inset: 0;
  background: var(--nd);
  display: flex; flex-direction: column;
  align-items: center; justify-content: center;
  gap: 16px; z-index: 10;
  transition: opacity .5s ease;
}
.nx-boot.done { opacity: 0; pointer-events: none; }

.nb-ico {
  width: 54px; height: 54px;
  animation: nbSpin 7s linear infinite;
  filter: drop-shadow(0 0 8px rgba(200,121,65,.4));
}
@keyframes nbSpin { to { transform: rotate(360deg); } }

.nb-lbl {
  font-family: var(--ff1);
  font-size: .6rem; font-weight: 700;
  letter-spacing: 5px;
  color: var(--no);
  text-shadow: 0 0 10px rgba(200,121,65,.5);
  margin: 0;
}
.nb-bar {
  width: 150px; height: 1px;
  background: rgba(200,121,65,.12);
  border-radius: 1px; overflow: hidden;
}
.nb-prog {
  height: 100%; width: 0%;
  background: linear-gradient(90deg, var(--no), var(--ng));
  transition: width .4s ease;
  box-shadow: 0 0 6px var(--no);
}
.nb-log {
  font-family: var(--ff2);
  font-size: .5rem;
  color: rgba(200,121,65,.25);
  text-align: left; width: 170px;
  line-height: 2; min-height: 44px;
}
.nb-ln { display: block; animation: nbIn .2s ease; }
@keyframes nbIn { from{opacity:0;transform:translateX(-5px)} to{opacity:1} }

/* â”€â”€ FOOTER â”€â”€ */
.nx-foot {
  display: flex; align-items: center; justify-content: space-between;
  padding: 5px 13px;
  border-top: .5px solid rgba(200,121,65,.06);
  flex-shrink: 0;
  position: relative;
}
.nx-foot span {
  font-family: var(--ff2);
  font-size: .5rem; letter-spacing: 2px;
  color: rgba(200,121,65,.22);
  display: flex; align-items: center; gap: 5px;
}
.nx-ft-dot {
  display: inline-block;
  width: 4px; height: 4px;
  border-radius: 50%;
  background: #39ff14;
  box-shadow: 0 0 5px #39ff14;
  animation: nxBlink 1.8s step-end infinite;
}

/* â”€â”€ FOOTER expandido â”€â”€ */
#nxPanel.expanded .nx-foot {
  border-top: 1px solid rgba(200,121,65,.1);
  background: linear-gradient(0deg, rgba(200,121,65,.03) 0%, transparent 100%);
  padding: 7px 16px;
  justify-content: space-between;
}
#nxPanel.expanded .nx-foot::after {
  content: 'NEURAL LINK Â· ENCRYPTED';
  font-family: var(--ff2);
  font-size: .45rem;
  letter-spacing: 2.5px;
  color: rgba(200,121,65,.18);
  position: absolute;
  bottom: 8px;
  left: 50%;
  transform: translateX(-50%);
  white-space: nowrap;
  pointer-events: none;
}
#nxOvr {
  display: none; position: fixed; inset: 0;
  background: rgba(0,0,0,.55);
  backdrop-filter: blur(3px);
  z-index: 9989;
}
#nxOvr.on { display: block; }

/* â”€â”€ MOBILE â”€â”€ */
@media (max-width: 480px) {
  :root { --bot: 80px; }
  #nxPanel { right: 8px; left: 8px; width: auto; height: 66svh; }
  #nxFab   { right: 16px; }
  #nxPanel.expanded {
    top: 8px; left: 8px; right: 8px; bottom: 8px;
  }
}
</style>

<!-- â•â•â•â•â•â•â•â•â•â• JS â•â•â•â•â•â•â•â•â•â• -->
<script>
(function(){
'use strict';
const fab=document.getElementById('nxFab'),
      pan=document.getElementById('nxPanel'),
      ovr=document.getElementById('nxOvr'),
      ifr=document.getElementById('nxIframe'),
      boot=document.getElementById('nxBoot'),
      prog=document.getElementById('nbProg'),
      lbl=document.getElementById('nbLbl'),
      log=document.getElementById('nbLog'),
      clk=document.getElementById('nxClk');

let open=false, exp=false, loaded=false;

/* Reloj */
(function tick(){
  const n=new Date(), p=v=>String(v).padStart(2,'0');
  clk.textContent=`${p(n.getHours())}:${p(n.getMinutes())}`;
  setTimeout(tick,10000);
})();

/* Boot */
const steps=['> CORE ACTIVO','> MODELO v4.0 OK','> MEMORIA CARGADA','> ENLACE NEURAL âœ“'];
function runBoot(cb){
  log.innerHTML=''; let i=0;
  const go=()=>{
    if(i>=steps.length){prog.style.width='100%';setTimeout(cb,450);return;}
    prog.style.width=Math.round((i+1)/steps.length*100)+'%';
    lbl.textContent=steps[i];
    const l=document.createElement('span');
    l.className='nb-ln'; l.textContent=steps[i];
    log.appendChild(l); i++;
    setTimeout(go,360);
  }; go();
}

ifr.addEventListener('load',()=>{
  if(ifr.src&&ifr.src!==location.href){
    ifr.classList.add('loaded');
    loaded=true;
  }
});

window.nxToggle=function(){
  open=!open;
  fab.classList.toggle('open',open);
  pan.classList.toggle('open',open);
  ovr.classList.toggle('on',open&&innerWidth<=480);
  if(open&&!loaded) runBoot(()=>{boot.classList.add('done');ifr.src=ifr.dataset.src;});
  if(!open&&exp){pan.classList.remove('expanded');ovr.classList.remove('on');exp=false;}
};

window.nxExpand=function(){
  exp=!exp;
  pan.classList.toggle('expanded',exp);
  ovr.classList.toggle('on',exp);
};

document.addEventListener('keydown',e=>{if(e.key==='Escape'&&open)nxToggle();});
})();
</script>
<!-- FIN NEXUS WIDGET v5 -->

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     ğŸ“ TUTORIAL BIBLIOTECA UPGAMES v2
     - Overlay bloqueante (usuario no puede interactuar)
     - Mobile-first responsive
     - Tooltip siempre visible en pantalla
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<style>
/* â”€â”€ OVERLAY BLOQUEANTE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
#btut-lock {
    display: none;
    position: fixed;
    inset: 0;
    z-index: 19990;
    /* bloquea todos los clics salvo los del tooltip */
    pointer-events: all;
    /* fondo semi-transparente oscuro */
    background: rgba(0, 0, 0, 0.0);
    touch-action: none;
}
#btut-lock.on { display: block; }

/* â”€â”€ SPOTLIGHT (encima del lock, recorte visual) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
#btut-spotlight {
    display: none;
    position: fixed;
    border-radius: 14px;
    /* sombra que crea el "agujero" visual */
    box-shadow: 0 0 0 9999px rgba(0, 0, 0, 0.80);
    transition: top    0.4s cubic-bezier(0.4,0,0.2,1),
                left   0.4s cubic-bezier(0.4,0,0.2,1),
                width  0.4s cubic-bezier(0.4,0,0.2,1),
                height 0.4s cubic-bezier(0.4,0,0.2,1);
    z-index: 19995;
    pointer-events: none;
}

/* â”€â”€ TOOLTIP â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
#btut-tooltip {
    display: none;
    position: fixed;
    z-index: 20000;
    background: #0f0f0f;
    border: 1.5px solid #5EFF43;
    border-radius: 18px;
    padding: 18px 18px 16px;
    box-shadow: 0 10px 50px rgba(94,255,67,0.2), 0 2px 16px rgba(0,0,0,0.8);
    font-family: 'Segoe UI', Roboto, sans-serif;
    pointer-events: all;
    /* Mobile: ancho basado en viewport */
    width: min(320px, calc(100vw - 24px));
    box-sizing: border-box;
}

/* Flecha del tooltip */
#btut-tooltip::before {
    content: '';
    position: absolute;
    width: 13px; height: 13px;
    background: #0f0f0f;
    border: 1.5px solid #5EFF43;
    transform: rotate(45deg);
    z-index: 1;
}
#btut-tooltip.arr-top::before    { top: -8px;    left: 26px;  border-right: none; border-bottom: none; }
#btut-tooltip.arr-bottom::before { bottom: -8px; left: 26px;  border-left: none;  border-top: none;    }
#btut-tooltip.arr-left::before   { left: -8px;   top: 20px;   border-right: none; border-top: none;    }
#btut-tooltip.arr-right::before  { right: -8px;  top: 20px;   border-left: none;  border-bottom: none; }
#btut-tooltip.arr-none::before   { display: none; }

/* Contenido del tooltip */
.btut-head {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
    gap: 8px;
}
.btut-badge {
    font-size: 0.6rem; font-weight: 900; letter-spacing: 1.5px;
    color: #5EFF43;
    background: rgba(94,255,67,0.1);
    border: 1px solid rgba(94,255,67,0.3);
    border-radius: 20px;
    padding: 3px 10px;
    text-transform: uppercase;
    white-space: nowrap;
    flex-shrink: 0;
}
.btut-close-btn {
    background: none; border: none;
    color: #555; cursor: pointer;
    font-size: 1rem; line-height: 1;
    padding: 4px; border-radius: 6px;
    transition: color 0.2s, background 0.2s;
    flex-shrink: 0;
    /* tap target mÃ¡s grande en mobile */
    min-width: 32px; min-height: 32px;
    display: flex; align-items: center; justify-content: center;
}
.btut-close-btn:hover, .btut-close-btn:active { color: #ff4343; background: rgba(255,67,67,0.1); }

.btut-title {
    font-size: 0.95rem; font-weight: 800;
    color: #fff; margin-bottom: 8px; line-height: 1.35;
}
.btut-body {
    font-size: 0.80rem; color: #aaa;
    line-height: 1.65; margin-bottom: 16px;
}
.btut-body strong { color: #5EFF43; }

.btut-foot {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 8px;
}
.btut-dots { display: flex; gap: 5px; align-items: center; flex-shrink: 0; }
.btut-dot  {
    width: 6px; height: 6px; border-radius: 50%;
    background: #2a2a2a;
    transition: background 0.3s, transform 0.3s;
}
.btut-dot.on { background: #5EFF43; transform: scale(1.3); }

.btut-nav { display: flex; gap: 8px; flex-shrink: 0; }
.btut-btn {
    padding: 9px 16px;
    border-radius: 9px;
    font-size: 0.72rem; font-weight: 800;
    letter-spacing: 0.5px;
    cursor: pointer; border: none;
    text-transform: uppercase;
    transition: all 0.18s;
    /* tap target ok en mobile */
    min-height: 38px;
}
.btut-btn-p { background: transparent; color: #555; border: 1px solid #2a2a2a; }
.btut-btn-p:hover, .btut-btn-p:active { color: #fff; border-color: #555; }
.btut-btn-n { background: #5EFF43; color: #000; }
.btut-btn-n:hover, .btut-btn-n:active { filter: brightness(1.1); transform: scale(0.97); }

/* â”€â”€ BOTÃ“N DE AYUDA FLOTANTE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
#btut-fab {
    position: fixed;
    bottom: 24px; left: 20px;
    z-index: 9500;
    background: #111;
    border: 1px solid #2a2a2a;
    border-radius: 50%;
    width: 48px; height: 48px;
    display: flex; align-items: center; justify-content: center;
    cursor: pointer;
    color: #5EFF43;
    font-size: 1.35rem;
    box-shadow: 0 4px 20px rgba(0,0,0,0.6);
    transition: border-color 0.2s, box-shadow 0.2s, transform 0.2s;
    -webkit-tap-highlight-color: transparent;
}
#btut-fab:hover, #btut-fab:active {
    border-color: #5EFF43;
    box-shadow: 0 4px 20px rgba(94,255,67,0.25);
    transform: scale(1.07);
}

/* â”€â”€ ANIMACIÃ“N ENTRADA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.btut-in { animation: btutSlideIn 0.3s ease forwards; }
@keyframes btutSlideIn {
    from { opacity: 0; transform: translateY(10px) scale(0.97); }
    to   { opacity: 1; transform: translateY(0)    scale(1);    }
}

/* â”€â”€ PULSE EN ELEMENTO RESALTADO â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.btut-pulse {
    outline: 2px solid rgba(94,255,67,0.7) !important;
    outline-offset: 3px !important;
    animation: btutPulseRing 1.5s ease-in-out infinite;
}
@keyframes btutPulseRing {
    0%,100% { outline-color: rgba(94,255,67,0.7); }
    50%      { outline-color: rgba(94,255,67,0.2); }
}

/* â”€â”€ MOBILE: tooltip siempre en la mitad baja â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
@media (max-width: 600px) {
    #btut-tooltip {
        width: calc(100vw - 20px);
        left: 10px !important;
        right: 10px;
        /* en mobile siempre abajo de la pantalla si no hay espacio */
    }
    #btut-tooltip.arr-top::before,
    #btut-tooltip.arr-bottom::before,
    #btut-tooltip.arr-left::before,
    #btut-tooltip.arr-right::before {
        left: 22px;
    }
}
</style>

<!-- OVERLAY DE BLOQUEO -->
<div id="btut-lock"></div>
<!-- SPOTLIGHT -->
<div id="btut-spotlight"></div>
<!-- TOOLTIP -->
<div id="btut-tooltip">
    <div class="btut-head">
        <span class="btut-badge" id="btut-badge">Tutorial</span>
        <button class="btut-close-btn" id="btut-close" aria-label="Cerrar tutorial">âœ•</button>
    </div>
    <div class="btut-title" id="btut-title"></div>
    <div class="btut-body"  id="btut-body"></div>
    <div class="btut-foot">
        <div class="btut-dots" id="btut-dots"></div>
        <div class="btut-nav">
            <button class="btut-btn btut-btn-p" id="btut-prev">â† AtrÃ¡s</button>
            <button class="btut-btn btut-btn-n" id="btut-next">Siguiente â†’</button>
        </div>
    </div>
</div>
<!-- BOTÃ“N FAB DE AYUDA -->
<button id="btut-fab" aria-label="Ver tutorial">
    <ion-icon name="help-circle-outline"></ion-icon>
</button>

<script>
(function(){
'use strict';

/* â”€â”€ PASOS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   pos valores:
     center   â†’ tooltip centrado, sin spotlight
     below    â†’ tooltip debajo del elemento
     above    â†’ tooltip encima del elemento
     header-b â†’ elemento en header, tooltip debajo
     left     â†’ tooltip a la izquierda del elemento
   anchor: posiciÃ³n fija del tooltip en mobile cuando
           el espacio es muy reducido
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const STEPS = [
    {
        sel: null,
        title: "ğŸ® Â¡Bienvenido a UpGames!",
        body:  "AquÃ­ estÃ¡ <strong>todo el contenido</strong> de la comunidad: juegos, apps, mods y software. Este tutorial rÃ¡pido te explica cÃ³mo funciona todo. Â¡En menos de 2 minutos sabrÃ¡s usarlo todo!",
        pos:   "center"
    },
    {
        sel:   ".buscador-wrapper",
        title: "ğŸ” Paso 1: El Buscador",
        body:  "Escribe aquÃ­ lo que buscas. Funciona por <strong>tÃ­tulo, categorÃ­a, usuario o etiquetas</strong>. Los resultados se filtran automÃ¡ticamente mientras escribes, sin necesidad de presionar Enter.",
        pos:   "header-b"
    },
    {
        sel:   ".juego-card",
        title: "ğŸ“¦ Paso 2: Las Cards",
        body:  "Cada tarjeta es un aporte de la comunidad. Muestra imagen, tÃ­tulo, quiÃ©n lo subiÃ³ y las descargas. <strong>Toca una card</strong> para expandirla y ver todos los detalles.",
        pos:   "below"
    },
    {
        sel:   ".juego-card",
        title: "ğŸ“¦ Dentro de la Card",
        body:  "Al expandir verÃ¡s: descripciÃ³n, el botÃ³n <strong>ACCEDER A LA NUBE</strong> para descargar, y los botones â¤ï¸ <strong>favorito</strong> Â· ğŸ“¤ <strong>compartir</strong> Â· ğŸš© <strong>reportar link</strong>. TambiÃ©n hay una secciÃ³n de <strong>Opiniones</strong> para comentar.",
        pos:   "below"
    },
    {
        sel:   ".user-tag",
        title: "ğŸ‘¤ Paso 3: El Autor",
        body:  "El <strong>@usuario</strong> es quien subiÃ³ el contenido. TÃ³calo para ver su perfil pÃºblico y todos sus aportes. El âœ“ de colores indica su <strong>nivel de confianza</strong> dentro de la comunidad.",
        pos:   "below"
    },
    {
        sel:   ".status-badge",
        title: "ğŸŸ¢ Estado del Enlace",
        body:  "<strong>Online</strong> = funciona perfecto. <strong>RevisiÃ³n</strong> = fue reportado por usuarios y el equipo lo estÃ¡ revisando. <strong>CaÃ­do</strong> = el enlace ya no funciona. AsÃ­ sabes antes de intentar descargar.",
        pos:   "below"
    },
    {
        sel:   ".UpIcon",
        title: "â˜ï¸ Paso 4: Subir Contenido",
        body:  "Â¿Tienes algo para compartir? Toca este botÃ³n de nube para ir a tu <strong>perfil de publicador</strong>. Puedes subir juegos, apps o software y <strong>ganar $1 USD por cada 1,000 descargas</strong>.",
        pos:   "header-b"
    },
    {
        sel:   ".reportButton",
        title: "ğŸš¨ Paso 5: Reportar Abuso",
        body:  "Este botÃ³n (â“˜) es para reportar contenido <strong>ilegal, peligroso o inapropiado</strong> directamente al equipo por email. Es distinto al ğŸš© de las cards â€” ese es para links caÃ­dos.",
        pos:   "header-b"
    },
    {
        sel:   "#nxFab",
        title: "ğŸ¤– Paso 6: NEXUS â€” Tu IA",
        body:  "Este botÃ³n con el <strong>ojo brillante</strong> abre NEXUS, la inteligencia artificial integrada de UpGames. EstÃ¡ disponible en cualquier momento desde cualquier pÃ¡gina.",
        pos:   "left"
    },
    {
        sel:   "#nxFab",
        title: "ğŸ¤– Â¿QuÃ© hace NEXUS?",
        body:  "EscrÃ­bele como si hablaras con una persona: <strong>\"Busco un mod de Minecraft\"</strong>, <strong>\"Â¿CÃ³mo subo contenido?\"</strong>, <strong>\"RecomiÃ©ndame un juego de terror\"</strong>. NEXUS entiende lenguaje natural y responde al instante.",
        pos:   "left"
    },
    {
        sel:   null,
        title: "ğŸ‰ Â¡Listo, ya sabes todo!",
        body:  "Ya conoces UpGames de punta a punta. Si en algÃºn momento tienes dudas, toca el botÃ³n <strong>?</strong> en la esquina inferior izquierda para ver este tutorial de nuevo. Â¡A disfrutar!",
        pos:   "center"
    }
];

/* â”€â”€ REFS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const lockEl  = document.getElementById('btut-lock');
const spotEl  = document.getElementById('btut-spotlight');
const tipEl   = document.getElementById('btut-tooltip');
const badgeEl = document.getElementById('btut-badge');
const titleEl = document.getElementById('btut-title');
const bodyEl  = document.getElementById('btut-body');
const dotsEl  = document.getElementById('btut-dots');
const prevBtn = document.getElementById('btut-prev');
const nextBtn = document.getElementById('btut-next');
const closeB  = document.getElementById('btut-close');
const fabBtn  = document.getElementById('btut-fab');

let idx    = 0;
let active = false;
let lastEl = null;

/* â”€â”€ API PÃšBLICA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
window.startBibliotecaTutorial = start;

function start() {
    idx    = 0;
    active = true;
    lockEl.classList.add('on');
    spotEl.style.display = 'block';
    tipEl.style.display  = 'block';
    document.body.style.overflow = 'hidden';
    render();
}

function finish() {
    active = false;
    lockEl.classList.remove('on');
    spotEl.style.display = 'none';
    tipEl.style.display  = 'none';
    document.body.style.overflow = '';
    clearPulse();
    localStorage.setItem('upgames_onboarding_done', '1');
}

/* â”€â”€ RENDER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function render() {
    const s = STEPS[idx];
    const total = STEPS.length;

    /* Contenido */
    badgeEl.textContent = `Tutorial Â· ${idx + 1}/${total}`;
    titleEl.textContent  = s.title;
    bodyEl.innerHTML     = s.body;

    /* Dots */
    dotsEl.innerHTML = '';
    STEPS.forEach((_, i) => {
        const d = document.createElement('span');
        d.className = 'btut-dot' + (i === idx ? ' on' : '');
        dotsEl.appendChild(d);
    });

    /* Botones */
    prevBtn.style.visibility = idx === 0 ? 'hidden' : 'visible';
    nextBtn.textContent = idx === total - 1 ? 'Finalizar âœ“' : 'Siguiente â†’';

    /* Limpiar highlight anterior */
    clearPulse();

    if (s.pos === 'center' || !s.sel) {
        hideSpot();
        placeCenter();
    } else {
        const el = document.querySelector(s.sel);
        if (!el) { hideSpot(); placeCenter(); }
        else      { spotOn(el, s); }
    }

    /* AnimaciÃ³n */
    tipEl.classList.remove('btut-in');
    void tipEl.offsetWidth;
    tipEl.classList.add('btut-in');
}

function spotOn(el, s) {
    const PAD  = 8;
    const rect = el.getBoundingClientRect();

    spotEl.style.top    = (rect.top  - PAD) + 'px';
    spotEl.style.left   = (rect.left - PAD) + 'px';
    spotEl.style.width  = (rect.width  + PAD * 2) + 'px';
    spotEl.style.height = (rect.height + PAD * 2) + 'px';
    spotEl.style.display = 'block';

    el.classList.add('btut-pulse');
    lastEl = el;

    placeTooltip(rect, s.pos);
}

function hideSpot() {
    spotEl.style.display = 'none';
}

function clearPulse() {
    if (lastEl) { lastEl.classList.remove('btut-pulse'); lastEl = null; }
}

/* â”€â”€ POSICIONAMIENTO DEL TOOLTIP (Mobile-first) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function placeCenter() {
    tipEl.className = 'btut-tooltip arr-none';
    tipEl.style.transform = 'translate(-50%, -50%)';
    tipEl.style.top  = '50%';
    tipEl.style.left = '50%';
}

function placeTooltip(rect, pos) {
    const isMobile = window.innerWidth <= 600;
    const TW = tipEl.offsetWidth  || 310;
    const TH = tipEl.offsetHeight || 230;
    const VW = window.innerWidth;
    const VH = window.innerHeight;
    const GAP = 14;

    tipEl.style.transform = '';

    let top, left, arrClass = 'arr-top';

    if (isMobile) {
        /* En mobile: tooltip siempre centrado horizontalmente,
           colocado en la mitad inferior si hay espacio,
           o superior si el elemento estÃ¡ muy abajo */
        left = 10;
        const spaceBelow = VH - rect.bottom;
        const spaceAbove = rect.top;

        if (spaceBelow >= TH + GAP + 20) {
            top = rect.bottom + GAP;
            arrClass = 'arr-top';
        } else if (spaceAbove >= TH + GAP + 20) {
            top = rect.top - TH - GAP;
            arrClass = 'arr-bottom';
        } else {
            /* Sin espacio ni arriba ni abajo: poner en zona segura */
            top = VH * 0.55;
            arrClass = 'arr-none';
        }
    } else {
        /* Desktop: posicionamiento inteligente */
        if (pos === 'below' || pos === 'header-b') {
            top  = rect.bottom + GAP;
            left = Math.max(10, rect.left);
            arrClass = 'arr-top';
        } else if (pos === 'above') {
            top  = rect.top - TH - GAP;
            left = Math.max(10, rect.left);
            arrClass = 'arr-bottom';
        } else if (pos === 'left') {
            top  = Math.max(10, rect.top);
            left = rect.left - TW - GAP;
            arrClass = 'arr-right';
            if (left < 10) { left = rect.right + GAP; arrClass = 'arr-left'; }
        }

        /* Evitar salir por la derecha */
        if (left + TW > VW - 10) left = VW - TW - 10;
        if (left < 10) left = 10;

        /* Evitar salir por abajo */
        if (top + TH > VH - 10) {
            top = rect.top - TH - GAP;
            arrClass = 'arr-bottom';
        }
        if (top < 10) top = 10;
    }

    tipEl.className = `btut-tooltip ${arrClass}`;
    tipEl.style.top  = top + 'px';
    tipEl.style.left = left + 'px';
}

/* â”€â”€ EVENTOS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
nextBtn.addEventListener('click', () => {
    if (idx < STEPS.length - 1) { idx++; render(); }
    else finish();
});
prevBtn.addEventListener('click', () => {
    if (idx > 0) { idx--; render(); }
});
closeB.addEventListener('click', finish);
fabBtn.addEventListener('click', start);

/* Bloquear cualquier toque/click en el overlay de bloqueo */
lockEl.addEventListener('click',      e => e.stopPropagation(), true);
lockEl.addEventListener('touchstart', e => e.preventDefault(),  { passive: false });
lockEl.addEventListener('touchmove',  e => e.preventDefault(),  { passive: false });

/* Teclas de navegaciÃ³n en desktop */
document.addEventListener('keydown', e => {
    if (!active) return;
    if (e.key === 'ArrowRight' || e.key === 'Enter') nextBtn.click();
    if (e.key === 'ArrowLeft')  prevBtn.click();
    if (e.key === 'Escape')     finish();
});

/* Recalcular si rota el dispositivo */
window.addEventListener('resize', () => { if (active) render(); });

})();
</script>
<!-- FIN TUTORIAL BIBLIOTECA v2 -->

    
</body>
</html>
