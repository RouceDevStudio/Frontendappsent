<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UpGames - LibrerÃ­a Digital</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://unpkg.com">
    <link rel="stylesheet" href="./styles.css">
</head>
<body>
    <!-- PRELOADER OPTIMIZADO -->
    <div id="upgames-preloader">
        <div class="pl-bg-glow"></div>
        <div class="pl-center">
            <div class="pl-logo-wrap">
                <div class="pl-logo-ring"></div>
                <div class="pl-logo-ring pl-ring-2"></div>
                <div class="pl-logo-text">
                    <span class="pl-up">UP</span><span class="pl-gm">GAMES</span>
                </div>
            </div>
            <div class="pl-particles">
                <span class="pl-dot" style="--x:20%;--y:30%;--d:1.2s"></span>
                <span class="pl-dot" style="--x:80%;--y:20%;--d:0.8s"></span>
                <span class="pl-dot" style="--x:15%;--y:70%;--d:1.6s"></span>
                <span class="pl-dot" style="--x:75%;--y:65%;--d:0.5s"></span>
                <span class="pl-dot" style="--x:50%;--y:85%;--d:1.0s"></span>
                <span class="pl-dot pl-dot-blue" style="--x:35%;--y:15%;--d:0.7s"></span>
                <span class="pl-dot pl-dot-blue" style="--x:88%;--y:50%;--d:1.4s"></span>
            </div>
            <div class="pl-bar-track">
                <div class="pl-bar-fill" id="pl-bar"></div>
            </div>
            <p class="pl-tagline" id="pl-tagline">LA NUBE DE CONTENIDO</p>
        </div>
    </div>

    <!-- LOADING STATE -->
    <div id="loading-state" style="display:none;
        position: fixed; top: 50%; left: 50%;
        transform: translate(-50%, -50%);
        text-align: center; z-index: 9999;">
        <div style="width:50px;height:50px;border:3px solid #222;
            border-top-color:#5EFF43;border-radius:50%;
            animation:spin 0.9s linear infinite;margin:0 auto 16px;"></div>
        <p style="color:#5EFF43;font-size:0.8rem;font-weight:700;letter-spacing:2px;">
            CARGANDO NUBE...
        </p>
    </div>

    <style>
        @keyframes spin { to { transform: rotate(360deg); } }

        /* â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” PRELOADER OPTIMIZADO â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” */
        #upgames-preloader {
            position: fixed;
            inset: 0;
            background: #080808;
            z-index: 99999;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            transition: opacity 0.6s ease, visibility 0.6s ease;
        }
        #upgames-preloader.ocultar {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
        }

        .pl-bg-glow {
            position: absolute;
            width: 600px; height: 600px;
            background: radial-gradient(circle, rgba(94,255,67,0.06) 0%, transparent 70%);
            border-radius: 50%;
            animation: plGlowPulse 3s ease-in-out infinite;
            pointer-events: none;
        }
        @keyframes plGlowPulse {
            0%, 100% { transform: scale(1);   opacity: 0.6; }
            50%       { transform: scale(1.15); opacity: 1;   }
        }

        .pl-center {
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 36px;
        }

        .pl-logo-wrap {
            position: relative;
            width: 140px; height: 140px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .pl-logo-ring {
            position: absolute;
            inset: 0;
            border-radius: 50%;
            border: 1.5px solid transparent;
            border-top-color: #5EFF43;
            border-right-color: rgba(94,255,67,0.2);
            animation: plSpin 2.2s linear infinite;
        }
        .pl-ring-2 {
            inset: 14px;
            border-top-color: transparent;
            border-bottom-color: #00f2ff;
            border-left-color: rgba(0,242,255,0.2);
            animation: plSpinRev 3s linear infinite;
        }
        @keyframes plSpin    { to { transform: rotate(360deg);  } }
        @keyframes plSpinRev { to { transform: rotate(-360deg); } }

        .pl-logo-text {
            font-size: 1.6rem;
            font-weight: 900;
            letter-spacing: 2px;
            animation: plLogoPulse 2s ease-in-out infinite;
            user-select: none;
        }
        .pl-up { color: #5EFF43; text-shadow: 0 0 18px rgba(94,255,67,0.7); }
        .pl-gm { color: #fff; }
        @keyframes plLogoPulse {
            0%, 100% { opacity: 1;    transform: scale(1);    }
            50%       { opacity: 0.85; transform: scale(0.97); }
        }

        .pl-particles { position: fixed; inset: 0; pointer-events: none; }
        .pl-dot {
            position: absolute;
            left: var(--x);
            top: var(--y);
            width: 4px; height: 4px;
            background: rgba(94,255,67,0.5);
            border-radius: 50%;
            animation: plFloat var(--d, 1s) ease-in-out infinite alternate;
            box-shadow: 0 0 6px rgba(94,255,67,0.4);
        }
        .pl-dot-blue {
            background: rgba(0,242,255,0.5);
            box-shadow: 0 0 6px rgba(0,242,255,0.4);
        }
        @keyframes plFloat {
            from { transform: translateY(0px)  scale(1);    opacity: 0.4; }
            to   { transform: translateY(-14px) scale(1.3); opacity: 1;   }
        }

        .pl-bar-track {
            width: 200px; height: 2px;
            background: #1a1a1a;
            border-radius: 10px;
            overflow: hidden;
        }
        .pl-bar-fill {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #5EFF43, #00f2ff);
            border-radius: 10px;
            transition: width 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 0 10px rgba(94,255,67,0.6);
        }

        .pl-tagline {
            color: #2a2a2a;
            font-size: 0.65rem;
            font-weight: 700;
            letter-spacing: 4px;
            text-transform: uppercase;
            animation: plTagFade 2s ease-in-out infinite alternate;
        }
        @keyframes plTagFade {
            from { color: #222; }
            to   { color: #444; }
        }
    </style>

    <script>
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // LÃ“GICA DEL PRELOADER OPTIMIZADO
    // Progresa rÃ¡pido hasta 70% y espera al backend
    // Si no responde en 3 segundos, cierra igual
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    (function initPreloader() {
        const preloader = document.getElementById('upgames-preloader');
        const bar       = document.getElementById('pl-bar');
        const tagline   = document.getElementById('pl-tagline');

        let cerrado = false;
        let backendCargado = false;

        // Avance rÃ¡pido hasta 70% en 600ms
        const etapas = [
            { pct: 30, delay: 200  },
            { pct: 50, delay: 400  },
            { pct: 70, delay: 600 }
        ];

        function avanzarBarra() {
            let i = 0;
            function siguiente() {
                if (i >= etapas.length || cerrado) return;
                bar.style.width = etapas[i].pct + '%';
                i++;
                if (i < etapas.length) {
                    setTimeout(siguiente, etapas[i].delay - (etapas[i-1]?.delay || 0));
                }
            }
            siguiente();
        }

        function cerrarPreloader() {
            if (cerrado) return;
            cerrado = true;
            bar.style.width = '100%';
            setTimeout(() => {
                preloader.classList.add('ocultar');
            }, 300);
        }

        // Iniciar progreso
        avanzarBarra();

        // Escuchar cuando el backend estÃ© listo
        window.addEventListener('backendReady', () => {
            backendCargado = true;
            cerrarPreloader();
        });

        // Timeout: si backend no responde en 3s, cerrar igual
        setTimeout(() => {
            if (!backendCargado) {
                console.warn('Backend tardÃ³ mÃ¡s de 3s, cerrando preloader');
                cerrarPreloader();
            }
        }, 3000);
    })();
    </script>

    <!-- HEADER MEJORADO -->
    <header>
        <div class="buscador-wrapper">
            <ion-icon name="search-outline" class="buscador-icon"></ion-icon>
            <input type="text" id="buscador" placeholder="Buscar...">
        </div>
        
        <div class="header-right-actions">
            <button class="UpIcon" onclick="window.location.href='./perfil.html'" title="Subir archivo">
                <ion-icon name="cloud-upload"></ion-icon>
            </button>
            
            <a class="reportButton" id="reportButton" href="#" onclick="handleMail(event)">
                <ion-icon name="information-circle"></ion-icon>
            </a>
        </div>
    </header>

    <!-- OVERLAY PARA MODAL -->
    <div class="expandida-overlay" id="overlay"></div>

    <!-- CONTENEDOR PRINCIPAL -->
    <div id="output"></div>

    <!-- MODAL DE TÃ‰RMINOS -->
    <div id="modal-terminos" class="custom-modal-wrapper">
        <div class="custom-modal-card">
            <div class="custom-modal-header">
                <span class="emoji-header">ğŸš€</span>
                <h1>BIENVENIDO A UPGAMES</h1>
                <p style="color: #888; font-size: 0.8rem; margin-top: 5px;">La evoluciÃ³n de las librerÃ­as digitales</p>
            </div>
            
            <div class="custom-modal-body">
                <div class="benefits-section">
                    <h3>ğŸ’ BENEFICIOS EXCLUSIVOS</h3>
                    <ul class="benefits-list">
                        <li><strong>MonetizaciÃ³n Real:</strong> Gana $1.00 USD por cada 1,000 descargas de tus aportes.</li>
                        <li><strong>Lanzadera Indie:</strong> Publica tus propios juegos, apps o mods con visibilidad global gratuita.</li>
                        <li><strong>Seguridad 24/7:</strong> Navega tranquilo gracias a nuestros bots que filtran malware y contenido +18.</li>
                        <li><strong>Comunidad Activa:</strong> Indexa y encuentra metadatos de software que no hallarÃ¡s en tiendas oficiales.</li>
                        <li><strong>Estatus de Trusted Indexer:</strong> Sube de nivel y obtÃ©n prioridad en el feed principal.</li>
                        <li><strong>NEXUS IA Integrada:</strong> Accede a nuestra inteligencia artificial exclusiva para encontrar contenido, resolver dudas y recibir recomendaciones personalizadas â€” sin salir de la plataforma.</li>
                    </ul>
                </div>

                <hr style="border: 0; border-top: 1px solid #333; margin: 20px 0;">

                <h3>âš–ï¸ BREVE RESUMEN LEGAL</h3>
                <p>Para mantener este ecosistema seguro y gratuito, operamos bajo estas reglas:</p>
                <ul class="legal-summary">
                    <li><strong>IntermediaciÃ³n:</strong> Somos una librerÃ­a de metadatos; no almacenamos archivos.</li>
                    <li><strong>Responsabilidad:</strong> El contenido es responsabilidad de quien lo publica y lo descarga.</li>
                    <li><strong>Filtros Activos:</strong> Prohibido el contenido ilegal, piraterÃ­a o material sensible.</li>
                    <li><strong>Neutralidad:</strong> No podemos revisar miles de links manualmente, pero atendemos reportes en 24-72h.</li>
                </ul>
            </div>

            <div class="custom-modal-footer">
                <a href="./terminos&condiciones.html" class="legal-link">Conoce nuestro contrato legal completo (v.2026.C)</a>
                
                <div class="button-group">
                    <button id="btn-aceptar-terminos" class="btn-confirm">âœ“ ACEPTAR Y EMPEZAR A GANAR</button>
                    <button onclick="window.location.href='https://google.com'" class="btn-cancel">RECHAZAR</button>
                </div>
            </div>
        </div>
    </div>

    <style>
        :root {
            --neon-green: #39ff14;
            --neon-blue: #00f2ff;
            --glass-bg: #0d0d0d;
            --text-gray: #bbb;
        }

        .custom-modal-wrapper {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(15px);
            z-index: 10000;
            padding: 15px;
            font-family: 'Segoe UI', Roboto, sans-serif;
        }

        .custom-modal-card {
            position: relative;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--glass-bg);
            border: 1px solid #222;
            border-radius: 20px;
            width: 100%;
            max-width: 480px;
            max-height: 90vh;
            display: flex;
            flex-direction: column;
            box-shadow: 0 0 50px rgba(0, 242, 255, 0.15);
        }

        .custom-modal-header {
            padding: 25px 20px 15px;
            text-align: center;
            border-bottom: 1px solid #222;
        }

        .emoji-header { font-size: 2.5rem; filter: drop-shadow(0 0 10px var(--neon-blue)); }

        .custom-modal-header h1 {
            color: #fff;
            font-size: 1.4rem;
            margin: 10px 0 0;
            letter-spacing: 2px;
            text-transform: uppercase;
        }

        .custom-modal-body {
            padding: 25px;
            overflow-y: auto;
            color: var(--text-gray);
            font-size: 0.95rem;
            line-height: 1.5;
        }

        .custom-modal-body h3 {
            color: var(--neon-blue);
            font-size: 0.9rem;
            margin-bottom: 12px;
            letter-spacing: 1px;
        }

        .benefits-list, .legal-summary {
            padding-left: 15px;
            list-style: none;
        }

        .benefits-list li::before {
            content: "âœ¦";
            color: var(--neon-green);
            margin-right: 10px;
            font-weight: bold;
        }

        .legal-summary li::before {
            content: "â€¢";
            color: #ff003c;
            margin-right: 10px;
        }

        .benefits-list li, .legal-summary li {
            margin-bottom: 10px;
        }

        .custom-modal-footer {
            padding: 20px;
            background: rgba(0,0,0,0.4);
            border-top: 1px solid #222;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .legal-link {
            color: var(--neon-blue);
            font-size: 0.8rem;
            text-align: center;
            text-decoration: none;
            border-bottom: 1px solid transparent;
            transition: 0.3s;
        }

        .legal-link:hover { border-bottom: 1px solid var(--neon-blue); }

        .button-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .btn-confirm {
            background: var(--neon-green);
            color: #000;
            border: none;
            padding: 16px;
            border-radius: 10px;
            font-weight: 900;
            cursor: pointer;
            width: 100%;
            text-transform: uppercase;
            transition: 0.3s;
        }

        .btn-confirm:hover {
            background: #fff;
            box-shadow: 0 0 20px var(--neon-green);
        }

        .btn-cancel {
            background: transparent;
            color: #666;
            border: 1px solid #333;
            padding: 10px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 0.8rem;
        }

        @media (min-width: 600px) {
            .button-group { flex-direction: row; }
            .btn-confirm { flex: 2; }
            .btn-cancel { flex: 1; }
        }

        .custom-modal-body::-webkit-scrollbar { width: 5px; }
        .custom-modal-body::-webkit-scrollbar-thumb { background: #333; border-radius: 10px; }
    </style>

    <script>
        (function() {
            const modal = document.getElementById('modal-terminos');
            const btnAceptar = document.getElementById('btn-aceptar-terminos');
            const modalBody = modal.querySelector('.custom-modal-body');

            // Solo mostrar si es la primera vez (nunca completÃ³ el onboarding)
            const esPrimeraVez = localStorage.getItem("upgames_onboarding_done") !== "1";

            if (esPrimeraVez) {
                modal.style.display = 'block';
                document.body.style.overflow = 'hidden';

                // Bloquear botÃ³n hasta que el usuario haga scroll hasta el fondo
                btnAceptar.disabled = true;
                btnAceptar.style.opacity = '0.4';
                btnAceptar.style.cursor = 'not-allowed';
                btnAceptar.textContent = 'ğŸ“– DesplÃ¡zate para leer los tÃ©rminos...';

                let leido = false;
                modalBody.addEventListener('scroll', function() {
                    if (!leido) {
                        const scrolled = modalBody.scrollTop + modalBody.clientHeight;
                        const total = modalBody.scrollHeight;
                        if (scrolled >= total - 30) {
                            leido = true;
                            btnAceptar.disabled = false;
                            btnAceptar.style.opacity = '1';
                            btnAceptar.style.cursor = 'pointer';
                            btnAceptar.textContent = 'âœ“ ACEPTAR Y EMPEZAR A GANAR';
                        }
                    }
                });
            }

            btnAceptar.addEventListener('click', () => {
                if (btnAceptar.disabled) return;
                localStorage.setItem("upgames_terms_version", "2026.C");
                modal.style.display = 'none';
                document.body.style.overflow = 'auto';
                // Disparar tutorial solo la primera vez
                if (esPrimeraVez) {
                    setTimeout(() => {
                        if (typeof startBibliotecaTutorial === 'function') startBibliotecaTutorial();
                    }, 600);
                }
            });
        })();
    </script>

    <!-- IONICONS -->
    <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>

    <!-- SCRIPT PRINCIPAL -->
    <script src="./script.js"></script>
    
    <!-- FUNCIÃ“N DE SOPORTE -->
    <script>
        function handleMail(event) {
            event.preventDefault();
            const email = 'mr.m0onster@protonmail.com';
            const subject = encodeURIComponent('Soporte - UP GAMES');
            const body = encodeURIComponent('Hola, necesito ayuda con...\n\n[Describe tu problema aquÃ­]');
            window.location.href = `mailto:${email}?subject=${subject}&body=${body}`;
        }
    </script>
    
    
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     NEXUS IA WIDGET â€” UpGames
     Archivo standalone Â· Pega este bloque antes de </body>
     Paleta: #5EFF43 (verde) Â· #00f2ff (cyan) Â· #000/#0f0f0f/#1a1a1a
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

<!-- â”€â”€ FAB â”€â”€ -->
<button id="nxFab" onclick="nxToggle()" aria-label="Abrir Nexus IA">
  <span class="nxf-r1"></span>
  <span class="nxf-r2"></span>
  <div class="nxf-inner">
    <!-- Icono: hexÃ¡gono IA -->
    <svg viewBox="0 0 40 40" fill="none" class="nxf-ico">
      <path d="M20 3L35.59 12V28L20 37L4.41 28V12L20 3Z"
            stroke="url(#fabG)" stroke-width="1.1" fill="none" opacity=".45"/>
      <path d="M20 9.5L30 15.5V25.5L20 31.5L10 25.5V15.5L20 9.5Z"
            stroke="url(#fabG)" stroke-width=".8" fill="none" opacity=".7"/>
      <line x1="20" y1="14" x2="20" y2="26"
            stroke="url(#fabG)" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="14" y1="20" x2="26" y2="20"
            stroke="url(#fabG)" stroke-width="1.5" stroke-linecap="round"/>
      <circle cx="20" cy="20" r="2.8" fill="url(#fabG)"/>
      <circle cx="20" cy="3"    r="1.3" fill="#5EFF43" opacity=".9"/>
      <circle cx="35.59" cy="12" r="1"  fill="#00f2ff" opacity=".7"/>
      <circle cx="35.59" cy="28" r="1"  fill="#00f2ff" opacity=".7"/>
      <circle cx="20" cy="37"   r="1.3" fill="#5EFF43" opacity=".9"/>
      <circle cx="4.41" cy="28" r="1"   fill="#00f2ff" opacity=".7"/>
      <circle cx="4.41" cy="12" r="1"   fill="#00f2ff" opacity=".7"/>
      <defs>
        <linearGradient id="fabG" x1="4" y1="4" x2="36" y2="36" gradientUnits="userSpaceOnUse">
          <stop offset="0%"   stop-color="#5EFF43"/>
          <stop offset="100%" stop-color="#00f2ff"/>
        </linearGradient>
      </defs>
    </svg>
    <span class="nxf-tag">IA</span>
  </div>
</button>

<!-- â”€â”€ PANEL â”€â”€ -->
<div id="nxPanel" role="dialog" aria-label="Nexus IA">

  <!-- Esquinas HUD (solo en modo expandido) -->
  <b class="nx-c nx-c-tl"></b>
  <b class="nx-c nx-c-tr"></b>
  <b class="nx-c nx-c-bl"></b>
  <b class="nx-c nx-c-br"></b>

  <!-- Header -->
  <header class="nx-hdr">
    <div class="nx-hdr-l">
      <div class="nx-logo-box">
        <svg viewBox="0 0 24 24" fill="none" class="nx-lsvg">
          <path d="M12 2L22 12L12 22L2 12Z"
                stroke="url(#hdrG)" stroke-width=".9" opacity=".4"/>
          <path d="M12 7L17 12L12 17L7 12Z"
                stroke="url(#hdrG)" stroke-width=".7" opacity=".7"/>
          <line x1="12" y1="9"  x2="12" y2="15"
                stroke="#00f2ff" stroke-width="1.3" stroke-linecap="round"/>
          <line x1="9"  y1="12" x2="15" y2="12"
                stroke="#00f2ff" stroke-width="1.3" stroke-linecap="round"/>
          <circle cx="12" cy="12" r="2" fill="#5EFF43"/>
          <defs>
            <linearGradient id="hdrG" x1="2" y1="2" x2="22" y2="22" gradientUnits="userSpaceOnUse">
              <stop stop-color="#5EFF43"/>
              <stop offset="1" stop-color="#00f2ff"/>
            </linearGradient>
          </defs>
        </svg>
        <span class="nx-live"></span>
      </div>
      <div class="nx-titles">
        <span class="nx-name">NEXUS <em>IA</em></span>
        <span class="nx-sub">UPGAMES Â· <span id="nxClk">â”€â”€:â”€â”€</span></span>
      </div>
    </div>
    <div class="nx-hdr-r">
      <button class="nx-ibtn" id="nxExpBtn" onclick="nxExpand()" title="Expandir">
        <svg id="nxExpIco" viewBox="0 0 16 16" fill="none"
             stroke="currentColor" stroke-width="1.7" stroke-linecap="round">
          <path d="M2 6V2h4M10 2h4v4M14 10v4h-4M6 14H2v-4"/>
        </svg>
      </button>
      <button class="nx-ibtn nx-ibtn-x" onclick="nxToggle()" title="Cerrar">âœ•</button>
    </div>
  </header>

  <!-- Divisor gradiente -->
  <div class="nx-div"></div>

  <!-- Body: iframe + boot -->
  <div class="nx-body">
    <iframe
      id="nxFrame"
      src=""
      data-src="https://backendbuscador.onrender.com"
      allow="microphone; clipboard-read; clipboard-write"
      title="Nexus IA"
      loading="lazy">
    </iframe>

    <!-- Pantalla de arranque -->
    <div id="nxBoot">
      <div class="nb-visual">
        <span class="nb-ring nb-ra"></span>
        <span class="nb-ring nb-rb"></span>
        <span class="nb-ring nb-rc"></span>
        <svg viewBox="0 0 52 52" fill="none" class="nb-ico">
          <path d="M26 2L50 26L26 50L2 26Z"
                stroke="#5EFF43" stroke-width=".9" opacity=".25"/>
          <path d="M26 10L42 26L26 42L10 26Z"
                stroke="#00f2ff" stroke-width=".7" opacity=".45"/>
          <line x1="26" y1="18" x2="26" y2="34"
                stroke="#5EFF43" stroke-width="1.8" stroke-linecap="round"/>
          <line x1="18" y1="26" x2="34" y2="26"
                stroke="#5EFF43" stroke-width="1.8" stroke-linecap="round"/>
          <circle cx="26" cy="26" r="3.5" fill="#5EFF43" opacity=".9"/>
          <circle cx="26" cy="2"  r="1.4" fill="#5EFF43"/>
          <circle cx="50" cy="26" r="1.1" fill="#00f2ff"/>
          <circle cx="26" cy="50" r="1.4" fill="#5EFF43"/>
          <circle cx="2"  cy="26" r="1.1" fill="#00f2ff"/>
        </svg>
      </div>
      <div class="nb-info">
        <p class="nb-lbl" id="nbLbl">INICIANDO NEXUS</p>
        <div class="nb-barwrap">
          <div class="nb-bar"><div class="nb-fill" id="nbFill"></div></div>
          <span class="nb-pct" id="nbPct">0%</span>
        </div>
        <div class="nb-log" id="nbLog"></div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="nx-foot">
    <span class="nx-fl"><i class="nx-fdot"></i>EN LÃNEA</span>
    <span class="nx-fr">NEXUS v4.0</span>
  </footer>
</div>

<!-- Overlay -->
<div id="nxOvr" onclick="nxClose()"></div>


<!-- â•â•â•â•â•â•â•â•â•â•â•â• CSS â•â•â•â•â•â•â•â•â•â•â•â• -->
<style>
/* Tokens de color de UpGames, scope local */
#nxFab, #nxPanel, #nxBoot, #nxOvr {
  --g:   #5EFF43;
  --g1:  rgba(94,255,67,.07);
  --g2:  rgba(94,255,67,.14);
  --cy:  #00f2ff;
  --cy1: rgba(0,242,255,.08);
  --bk0: #000000;
  --bk1: #080808;
  --bk2: #0f0f0f;
  --bd:  #1a1a1a;
  --ts:  #555;
  --ff:  -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  --mo:  cubic-bezier(.4,0,.2,1);
  --sp:  cubic-bezier(.34,1.4,.64,1);
}

/* â”€â”€â”€ FAB â”€â”€â”€ */
#nxFab {
  position: fixed;
  bottom: 90px;
  right: 20px;
  width: 56px;
  height: 56px;
  border-radius: 14px;
  background: var(--bk1);
  border: 1px solid var(--bd);
  padding: 0;
  cursor: pointer;
  z-index: 9990;
  display: flex;
  align-items: center;
  justify-content: center;
  outline: none;
  -webkit-tap-highlight-color: transparent;
  box-shadow: 0 6px 24px rgba(0,0,0,.8);
  transition:
    transform .28s var(--sp),
    border-color .22s var(--mo),
    box-shadow .22s var(--mo);
}
#nxFab:hover {
  border-color: rgba(94,255,67,.3);
  box-shadow: 0 0 0 1px rgba(94,255,67,.08), 0 0 18px rgba(94,255,67,.1), 0 10px 36px rgba(0,0,0,.9);
  transform: translateY(-2px);
}
#nxFab.nx-open {
  border-color: rgba(94,255,67,.25);
  box-shadow: 0 0 0 1px rgba(94,255,67,.1), 0 0 22px rgba(94,255,67,.12), 0 14px 44px rgba(0,0,0,.9);
  transform: translateY(-1px) scale(.97);
}

/* Anillos del FAB */
.nxf-r1, .nxf-r2 {
  position: absolute;
  border-radius: 18px;
  pointer-events: none;
}
.nxf-r1 {
  inset: -2px;
  border: 1px solid rgba(94,255,67,.2);
  animation: nxfPulse 2.6s ease-in-out infinite;
}
.nxf-r2 {
  inset: -6px;
  border: 1px solid rgba(0,242,255,.09);
  border-radius: 22px;
  animation: nxfPulse 2.6s ease-in-out infinite .5s;
}
@keyframes nxfPulse {
  0%,100% { opacity:.6; transform:scale(1); }
  50%     { opacity:1;  transform:scale(1.04); }
}

.nxf-inner {
  position: relative;
  z-index: 2;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 1px;
}
.nxf-ico {
  width: 28px;
  height: 28px;
}
.nxf-tag {
  font-family: var(--ff);
  font-size: .37rem;
  font-weight: 900;
  letter-spacing: 3px;
  color: rgba(94,255,67,.45);
  line-height: 1;
}

/* â”€â”€â”€ PANEL â”€â”€â”€ */
#nxPanel {
  position: fixed;
  bottom: calc(90px + 56px + 12px);
  right: 20px;
  width: 355px;
  height: 548px;
  max-height: calc(100svh - 195px);
  background: var(--bk1);
  border: 1px solid var(--bd);
  border-radius: 20px;
  z-index: 9991;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  opacity: 0;
  transform: scale(.88) translateY(18px);
  transform-origin: bottom right;
  pointer-events: none;
  transition: opacity .3s var(--mo), transform .38s var(--sp);
  box-shadow:
    0 0 0 .5px rgba(94,255,67,.04),
    0 24px 70px rgba(0,0,0,.97),
    0 48px 100px rgba(0,0,0,.7);
}
#nxPanel.nx-open {
  opacity: 1;
  transform: scale(1) translateY(0);
  pointer-events: all;
}
#nxPanel.nx-exp {
  top: 16px; left: 16px; right: 16px; bottom: 16px;
  width: auto; height: auto; max-height: none;
  border-radius: 18px;
  border-color: rgba(94,255,67,.12);
}
#nxPanel.nx-exp .nx-c { opacity: 1; }

/* Esquinas HUD */
.nx-c {
  position: absolute;
  width: 13px; height: 13px;
  z-index: 20;
  pointer-events: none;
  opacity: 0;
  transition: opacity .3s var(--mo);
  display: block;
}
.nx-c-tl { top:-1px; left:-1px;  border-top:2px solid var(--g);  border-left:2px solid var(--g);  border-radius:18px 0 0 0; }
.nx-c-tr { top:-1px; right:-1px; border-top:2px solid var(--cy); border-right:2px solid var(--cy); border-radius:0 18px 0 0; }
.nx-c-bl { bottom:-1px; left:-1px;  border-bottom:2px solid var(--cy); border-left:2px solid var(--cy);  border-radius:0 0 0 18px; }
.nx-c-br { bottom:-1px; right:-1px; border-bottom:2px solid var(--g);  border-right:2px solid var(--g);  border-radius:0 0 18px 0; }

/* â”€â”€â”€ HEADER â”€â”€â”€ */
.nx-hdr {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 11px 13px 9px;
  flex-shrink: 0;
}
.nx-hdr-l, .nx-hdr-r {
  display: flex;
  align-items: center;
  gap: 9px;
}

.nx-logo-box {
  position: relative;
  width: 30px; height: 30px;
  background: var(--g1);
  border: 1px solid rgba(94,255,67,.18);
  border-radius: 9px;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}
.nx-lsvg { width: 16px; height: 16px; }

.nx-live {
  position: absolute;
  top: -2.5px; right: -2.5px;
  width: 6px; height: 6px;
  border-radius: 50%;
  background: var(--g);
  border: 1.5px solid var(--bk1);
  box-shadow: 0 0 5px var(--g);
  animation: nxBlink 2s step-end infinite;
}
@keyframes nxBlink { 0%,100%{opacity:1} 50%{opacity:.1} }

.nx-titles { display: flex; flex-direction: column; gap: 2px; }
.nx-name {
  font-family: var(--ff);
  font-size: .78rem;
  font-weight: 900;
  letter-spacing: 3.5px;
  color: var(--g);
  line-height: 1;
}
.nx-name em {
  font-style: normal;
  color: var(--cy);
  letter-spacing: 2px;
}
.nx-sub {
  font-family: 'Courier New', monospace;
  font-size: .44rem;
  letter-spacing: 1.5px;
  color: var(--ts);
  line-height: 1;
}

.nx-ibtn {
  width: 28px; height: 28px;
  background: rgba(255,255,255,.02);
  border: 1px solid var(--bd);
  border-radius: 8px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  color: #444;
  font-size: .78rem;
  line-height: 1;
  transition: border-color .18s, color .18s, background .18s;
  -webkit-tap-highlight-color: transparent;
}
.nx-ibtn svg { width: 11px; height: 11px; }
.nx-ibtn:hover {
  border-color: rgba(94,255,67,.25);
  color: var(--g);
  background: var(--g1);
}
.nx-ibtn-x:hover {
  border-color: rgba(255,60,75,.3);
  color: #ff3c4b;
  background: rgba(255,60,75,.05);
}

/* Divisor */
.nx-div {
  height: 1px;
  flex-shrink: 0;
  background: linear-gradient(90deg,
    transparent 0%,
    rgba(94,255,67,.16) 25%,
    rgba(0,242,255,.1)  65%,
    transparent 100%);
}

/* â”€â”€â”€ BODY â”€â”€â”€ */
.nx-body {
  flex: 1;
  position: relative;
  overflow: hidden;
  background: #030304;
}
#nxFrame {
  width: 100%; height: 100%;
  border: none; display: block;
  opacity: 0;
  transition: opacity .55s var(--mo);
}
#nxFrame.nx-on { opacity: 1; }

/* â”€â”€â”€ BOOT â”€â”€â”€ */
#nxBoot {
  position: absolute; inset: 0;
  background: var(--bk1);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 26px;
  z-index: 10;
  transition: opacity .5s var(--mo);
}
#nxBoot.nx-done { opacity: 0; pointer-events: none; }

.nb-visual {
  position: relative;
  width: 88px; height: 88px;
  display: flex;
  align-items: center;
  justify-content: center;
}
.nb-ring {
  position: absolute;
  border-radius: 50%;
  border: 1px solid transparent;
  display: block;
}
.nb-ra {
  inset: 0;
  border-color: rgba(94,255,67,.22) transparent rgba(94,255,67,.22) transparent;
  animation: nbSpin 2.2s linear infinite;
}
.nb-rb {
  inset: 10px;
  border-color: transparent rgba(0,242,255,.18) transparent rgba(0,242,255,.18);
  animation: nbSpin 1.7s linear infinite reverse;
}
.nb-rc {
  inset: 20px;
  border-color: rgba(94,255,67,.1) transparent rgba(94,255,67,.1) transparent;
  animation: nbSpin 3.1s linear infinite;
}
@keyframes nbSpin { to { transform: rotate(360deg); } }

.nb-ico {
  width: 42px; height: 42px;
  position: relative; z-index: 2;
}

.nb-info {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 10px;
  width: 185px;
}
.nb-lbl {
  font-family: var(--ff);
  font-size: .57rem;
  font-weight: 900;
  letter-spacing: 5px;
  color: var(--g);
  margin: 0;
  text-align: center;
}
.nb-barwrap {
  display: flex;
  align-items: center;
  gap: 7px;
  width: 100%;
}
.nb-bar {
  flex: 1;
  height: 2px;
  background: rgba(94,255,67,.07);
  border-radius: 2px;
  overflow: hidden;
}
.nb-fill {
  height: 100%;
  width: 0%;
  background: linear-gradient(90deg, var(--g), var(--cy));
  border-radius: 2px;
  transition: width .4s var(--mo);
}
.nb-pct {
  font-family: 'Courier New', monospace;
  font-size: .44rem;
  font-weight: 700;
  color: rgba(94,255,67,.4);
  min-width: 26px;
  text-align: right;
}
.nb-log {
  font-family: 'Courier New', monospace;
  font-size: .47rem;
  color: rgba(94,255,67,.2);
  width: 100%;
  line-height: 1.9;
  min-height: 46px;
  text-align: left;
}
.nb-ln { display: block; animation: nbLnIn .18s ease; }
@keyframes nbLnIn {
  from { opacity:0; transform:translateX(-5px); }
  to   { opacity:1; transform:translateX(0);    }
}

/* â”€â”€â”€ FOOTER â”€â”€â”€ */
.nx-foot {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 5px 13px;
  flex-shrink: 0;
  border-top: 1px solid rgba(94,255,67,.035);
}
.nx-fl, .nx-fr {
  font-family: 'Courier New', monospace;
  font-size: .44rem;
  letter-spacing: 2px;
  color: rgba(255,255,255,.1);
  display: flex;
  align-items: center;
  gap: 5px;
}
.nx-fdot {
  display: inline-block;
  width: 4px; height: 4px;
  border-radius: 50%;
  background: var(--g);
  box-shadow: 0 0 4px var(--g);
  animation: nxBlink 2s step-end infinite;
}

/* â”€â”€â”€ OVERLAY â”€â”€â”€ */
#nxOvr {
  display: none;
  position: fixed; inset: 0;
  background: rgba(0,0,0,.5);
  backdrop-filter: blur(3px);
  -webkit-backdrop-filter: blur(3px);
  z-index: 9989;
}
#nxOvr.nx-on { display: block; }

/* â”€â”€â”€ MOBILE â”€â”€â”€ */
@media (max-width: 480px) {
  #nxFab { bottom: 82px; right: 16px; }
  #nxPanel {
    right: 10px; left: 10px; width: auto;
    height: 65svh;
    bottom: calc(82px + 56px + 10px);
    border-radius: 18px;
  }
  #nxPanel.nx-exp {
    top: 10px; left: 10px; right: 10px; bottom: 10px;
    width: auto; height: auto;
  }
}
</style>


<!-- â•â•â•â•â•â•â•â•â•â•â•â• JS â•â•â•â•â•â•â•â•â•â•â•â• -->
<script>
(function () {
  'use strict';

  const $    = id => document.getElementById(id);
  const fab  = $('nxFab'),   pan  = $('nxPanel'), ovr  = $('nxOvr');
  const frm  = $('nxFrame'), boot = $('nxBoot'),  fill = $('nbFill');
  const pct  = $('nbPct'),   lbl  = $('nbLbl'),   log  = $('nbLog');
  const clk  = $('nxClk'),   ico  = $('nxExpIco');

  let open = false, exp = false, ready = false;

  /* Reloj */
  (function tick() {
    const d = new Date(), z = n => String(n).padStart(2,'0');
    clk.textContent = `${z(d.getHours())}:${z(d.getMinutes())}`;
    setTimeout(tick, 10000);
  })();

  /* Boot */
  const LINES = ['> KERNEL OK','> MODELO v4.0 âœ“','> CONTEXTO CARGADO','> SEGURIDAD ACTIVA','> LISTO'];
  function boot_run(cb) {
    log.innerHTML = ''; let i = 0;
    (function step() {
      if (i >= LINES.length) {
        fill.style.width = '100%'; pct.textContent = '100%';
        lbl.textContent = 'NEXUS LISTO'; setTimeout(cb, 460); return;
      }
      const p = Math.round((i + 1) / LINES.length * 100);
      fill.style.width = p + '%'; pct.textContent = p + '%';
      lbl.textContent = LINES[i];
      const el = document.createElement('span');
      el.className = 'nb-ln'; el.textContent = LINES[i];
      log.appendChild(el); i++; setTimeout(step, 345);
    })();
  }

  frm.addEventListener('load', () => {
    if (frm.src && frm.src !== location.href) { frm.classList.add('nx-on'); ready = true; }
  });

  function setOvr() {
    ovr.classList.toggle('nx-on', exp || (open && innerWidth <= 480));
  }
  function setExpIco() {
    ico.innerHTML = exp
      ? '<path d="M6 2h4v4M14 2h-4v4M10 14H6v-4M14 10v4h-4"/>'
      : '<path d="M2 6V2h4M10 2h4v4M14 10v4h-4M6 14H2v-4"/>';
  }

  window.nxToggle = function () {
    open = !open;
    fab.classList.toggle('nx-open', open);
    pan.classList.toggle('nx-open', open);
    setOvr();
    if (open && !ready) boot_run(() => { boot.classList.add('nx-done'); frm.src = frm.dataset.src; });
    if (!open && exp)   { exp = false; pan.classList.remove('nx-exp'); setOvr(); setExpIco(); }
    /* Ocultar scroll-tooltip de UpGames mientras Nexus estÃ¡ abierto */
    const sc = document.getElementById('sc-tip');
    if (sc) sc.style.display = open ? 'none' : '';
  };

  window.nxClose = function () {
    if (exp) { exp = false; pan.classList.remove('nx-exp'); setOvr(); setExpIco(); }
    else nxToggle();
  };

  window.nxExpand = function () {
    exp = !exp;
    pan.classList.toggle('nx-exp', exp);
    setOvr(); setExpIco();
  };

  document.addEventListener('keydown', e => {
    if (e.key !== 'Escape') return;
    if (exp) nxExpand(); else if (open) nxToggle();
  });
  window.addEventListener('resize', setOvr);

})();
</script>
<!-- â”€â”€ FIN NEXUS WIDGET â”€â”€ -->

  

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     ğŸ“ TUTORIAL BIBLIOTECA UPGAMES v2
     - Overlay bloqueante (usuario no puede interactuar)
     - Mobile-first responsive
     - Tooltip siempre visible en pantalla
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<style>
/* â”€â”€ OVERLAY BLOQUEANTE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
#btut-lock {
    display: none;
    position: fixed;
    inset: 0;
    z-index: 19990;
    /* bloquea todos los clics salvo los del tooltip */
    pointer-events: all;
    /* fondo semi-transparente oscuro */
    background: rgba(0, 0, 0, 0.0);
    touch-action: none;
}
#btut-lock.on { display: block; }

/* â”€â”€ SPOTLIGHT (encima del lock, recorte visual) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
#btut-spotlight {
    display: none;
    position: fixed;
    border-radius: 14px;
    /* sombra que crea el "agujero" visual */
    box-shadow: 0 0 0 9999px rgba(0, 0, 0, 0.80);
    transition: top    0.4s cubic-bezier(0.4,0,0.2,1),
                left   0.4s cubic-bezier(0.4,0,0.2,1),
                width  0.4s cubic-bezier(0.4,0,0.2,1),
                height 0.4s cubic-bezier(0.4,0,0.2,1);
    z-index: 19995;
    pointer-events: none;
}

/* â”€â”€ TOOLTIP â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
#btut-tooltip {
    display: none;
    position: fixed;
    z-index: 20000;
    background: #0f0f0f;
    border: 1.5px solid #5EFF43;
    border-radius: 18px;
    padding: 18px 18px 16px;
    box-shadow: 0 10px 50px rgba(94,255,67,0.2), 0 2px 16px rgba(0,0,0,0.8);
    font-family: 'Segoe UI', Roboto, sans-serif;
    pointer-events: all;
    /* Mobile: ancho basado en viewport */
    width: min(320px, calc(100vw - 24px));
    box-sizing: border-box;
}

/* Flecha del tooltip */
#btut-tooltip::before {
    content: '';
    position: absolute;
    width: 13px; height: 13px;
    background: #0f0f0f;
    border: 1.5px solid #5EFF43;
    transform: rotate(45deg);
    z-index: 1;
}
#btut-tooltip.arr-top::before    { top: -8px;    left: 26px;  border-right: none; border-bottom: none; }
#btut-tooltip.arr-bottom::before { bottom: -8px; left: 26px;  border-left: none;  border-top: none;    }
#btut-tooltip.arr-left::before   { left: -8px;   top: 20px;   border-right: none; border-top: none;    }
#btut-tooltip.arr-right::before  { right: -8px;  top: 20px;   border-left: none;  border-bottom: none; }
#btut-tooltip.arr-none::before   { display: none; }

/* Contenido del tooltip */
.btut-head {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
    gap: 8px;
}
.btut-badge {
    font-size: 0.6rem; font-weight: 900; letter-spacing: 1.5px;
    color: #5EFF43;
    background: rgba(94,255,67,0.1);
    border: 1px solid rgba(94,255,67,0.3);
    border-radius: 20px;
    padding: 3px 10px;
    text-transform: uppercase;
    white-space: nowrap;
    flex-shrink: 0;
}
.btut-close-btn {
    background: none; border: none;
    color: #555; cursor: pointer;
    font-size: 1rem; line-height: 1;
    padding: 4px; border-radius: 6px;
    transition: color 0.2s, background 0.2s;
    flex-shrink: 0;
    /* tap target mÃ¡s grande en mobile */
    min-width: 32px; min-height: 32px;
    display: flex; align-items: center; justify-content: center;
}
.btut-close-btn:hover, .btut-close-btn:active { color: #ff4343; background: rgba(255,67,67,0.1); }

.btut-title {
    font-size: 0.95rem; font-weight: 800;
    color: #fff; margin-bottom: 8px; line-height: 1.35;
}
.btut-body {
    font-size: 0.80rem; color: #aaa;
    line-height: 1.65; margin-bottom: 16px;
}
.btut-body strong { color: #5EFF43; }

.btut-foot {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 8px;
}
.btut-dots { display: flex; gap: 5px; align-items: center; flex-shrink: 0; }
.btut-dot  {
    width: 6px; height: 6px; border-radius: 50%;
    background: #2a2a2a;
    transition: background 0.3s, transform 0.3s;
}
.btut-dot.on { background: #5EFF43; transform: scale(1.3); }

.btut-nav { display: flex; gap: 8px; flex-shrink: 0; }
.btut-btn {
    padding: 9px 16px;
    border-radius: 9px;
    font-size: 0.72rem; font-weight: 800;
    letter-spacing: 0.5px;
    cursor: pointer; border: none;
    text-transform: uppercase;
    transition: all 0.18s;
    /* tap target ok en mobile */
    min-height: 38px;
}
.btut-btn-p { background: transparent; color: #555; border: 1px solid #2a2a2a; }
.btut-btn-p:hover, .btut-btn-p:active { color: #fff; border-color: #555; }
.btut-btn-n { background: #5EFF43; color: #000; }
.btut-btn-n:hover, .btut-btn-n:active { filter: brightness(1.1); transform: scale(0.97); }

/* â”€â”€ BOTÃ“N DE AYUDA FLOTANTE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
#btut-fab {
    position: fixed;
    bottom: 24px; left: 20px;
    z-index: 9500;
    background: #111;
    border: 1px solid #2a2a2a;
    border-radius: 50%;
    width: 48px; height: 48px;
    display: flex; align-items: center; justify-content: center;
    cursor: pointer;
    color: #5EFF43;
    font-size: 1.35rem;
    box-shadow: 0 4px 20px rgba(0,0,0,0.6);
    transition: border-color 0.2s, box-shadow 0.2s, transform 0.2s;
    -webkit-tap-highlight-color: transparent;
}
#btut-fab:hover, #btut-fab:active {
    border-color: #5EFF43;
    box-shadow: 0 4px 20px rgba(94,255,67,0.25);
    transform: scale(1.07);
}

/* â”€â”€ ANIMACIÃ“N ENTRADA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.btut-in { animation: btutSlideIn 0.3s ease forwards; }
@keyframes btutSlideIn {
    from { opacity: 0; transform: translateY(10px) scale(0.97); }
    to   { opacity: 1; transform: translateY(0)    scale(1);    }
}

/* â”€â”€ PULSE EN ELEMENTO RESALTADO â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.btut-pulse {
    outline: 2px solid rgba(94,255,67,0.7) !important;
    outline-offset: 3px !important;
    animation: btutPulseRing 1.5s ease-in-out infinite;
}
@keyframes btutPulseRing {
    0%,100% { outline-color: rgba(94,255,67,0.7); }
    50%      { outline-color: rgba(94,255,67,0.2); }
}

/* â”€â”€ MOBILE: tooltip siempre en la mitad baja â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
@media (max-width: 600px) {
    #btut-tooltip {
        width: calc(100vw - 20px);
        left: 10px !important;
        right: 10px;
        /* en mobile siempre abajo de la pantalla si no hay espacio */
    }
    #btut-tooltip.arr-top::before,
    #btut-tooltip.arr-bottom::before,
    #btut-tooltip.arr-left::before,
    #btut-tooltip.arr-right::before {
        left: 22px;
    }
}
</style>

<!-- OVERLAY DE BLOQUEO -->
<div id="btut-lock"></div>
<!-- SPOTLIGHT -->
<div id="btut-spotlight"></div>
<!-- TOOLTIP -->
<div id="btut-tooltip">
    <div class="btut-head">
        <span class="btut-badge" id="btut-badge">Tutorial</span>
        <button class="btut-close-btn" id="btut-close" aria-label="Cerrar tutorial">âœ•</button>
    </div>
    <div class="btut-title" id="btut-title"></div>
    <div class="btut-body"  id="btut-body"></div>
    <div class="btut-foot">
        <div class="btut-dots" id="btut-dots"></div>
        <div class="btut-nav">
            <button class="btut-btn btut-btn-p" id="btut-prev">â† AtrÃ¡s</button>
            <button class="btut-btn btut-btn-n" id="btut-next">Siguiente â†’</button>
        </div>
    </div>
</div>
<!-- BOTÃ“N FAB DE AYUDA -->
<button id="btut-fab" aria-label="Ver tutorial">
    <ion-icon name="help-circle-outline"></ion-icon>
</button>

<script>
(function(){
'use strict';

/* â”€â”€ PASOS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   pos valores:
     center   â†’ tooltip centrado, sin spotlight
     below    â†’ tooltip debajo del elemento
     above    â†’ tooltip encima del elemento
     header-b â†’ elemento en header, tooltip debajo
     left     â†’ tooltip a la izquierda del elemento
   anchor: posiciÃ³n fija del tooltip en mobile cuando
           el espacio es muy reducido
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const STEPS = [
    {
        sel: null,
        title: "ğŸ® Â¡Bienvenido a UpGames!",
        body:  "AquÃ­ estÃ¡ <strong>todo el contenido</strong> de la comunidad: juegos, apps, mods y software. Este tutorial rÃ¡pido te explica cÃ³mo funciona todo. Â¡En menos de 2 minutos sabrÃ¡s usarlo todo!",
        pos:   "center"
    },
    {
        sel:   ".buscador-wrapper",
        title: "ğŸ” Paso 1: El Buscador",
        body:  "Escribe aquÃ­ lo que buscas. Funciona por <strong>tÃ­tulo, categorÃ­a, usuario o etiquetas</strong>. Los resultados se filtran automÃ¡ticamente mientras escribes, sin necesidad de presionar Enter.",
        pos:   "header-b"
    },
    {
        sel:   ".juego-card",
        title: "ğŸ“¦ Paso 2: Las Cards",
        body:  "Cada tarjeta es un aporte de la comunidad. Muestra imagen, tÃ­tulo, quiÃ©n lo subiÃ³ y las descargas. <strong>Toca una card</strong> para expandirla y ver todos los detalles.",
        pos:   "below"
    },
    {
        sel:   ".juego-card",
        title: "ğŸ“¦ Dentro de la Card",
        body:  "Al expandir verÃ¡s: descripciÃ³n, el botÃ³n <strong>ACCEDER A LA NUBE</strong> para descargar, y los botones â¤ï¸ <strong>favorito</strong> Â· ğŸ“¤ <strong>compartir</strong> Â· ğŸš© <strong>reportar link</strong>. TambiÃ©n hay una secciÃ³n de <strong>Opiniones</strong> para comentar.",
        pos:   "below"
    },
    {
        sel:   ".user-tag",
        title: "ğŸ‘¤ Paso 3: El Autor",
        body:  "El <strong>@usuario</strong> es quien subiÃ³ el contenido. TÃ³calo para ver su perfil pÃºblico y todos sus aportes. El âœ“ de colores indica su <strong>nivel de confianza</strong> dentro de la comunidad.",
        pos:   "below"
    },
    {
        sel:   ".status-badge",
        title: "ğŸŸ¢ Estado del Enlace",
        body:  "<strong>Online</strong> = funciona perfecto. <strong>RevisiÃ³n</strong> = fue reportado por usuarios y el equipo lo estÃ¡ revisando. <strong>CaÃ­do</strong> = el enlace ya no funciona. AsÃ­ sabes antes de intentar descargar.",
        pos:   "below"
    },
    {
        sel:   ".UpIcon",
        title: "â˜ï¸ Paso 4: Subir Contenido",
        body:  "Â¿Tienes algo para compartir? Toca este botÃ³n de nube para ir a tu <strong>perfil de publicador</strong>. Puedes subir juegos, apps o software y <strong>ganar $1 USD por cada 1,000 descargas</strong>.",
        pos:   "header-b"
    },
    {
        sel:   ".reportButton",
        title: "ğŸš¨ Paso 5: Reportar Abuso",
        body:  "Este botÃ³n (â“˜) es para reportar contenido <strong>ilegal, peligroso o inapropiado</strong> directamente al equipo por email. Es distinto al ğŸš© de las cards â€” ese es para links caÃ­dos.",
        pos:   "header-b"
    },
    {
        sel:   "#nxFab",
        title: "ğŸ¤– Paso 6: NEXUS â€” Tu IA",
        body:  "Este botÃ³n con el <strong>ojo brillante</strong> abre NEXUS, la inteligencia artificial integrada de UpGames. EstÃ¡ disponible en cualquier momento desde cualquier pÃ¡gina.",
        pos:   "left"
    },
    {
        sel:   "#nxFab",
        title: "ğŸ¤– Â¿QuÃ© hace NEXUS?",
        body:  "EscrÃ­bele como si hablaras con una persona: <strong>\"Busco un mod de Minecraft\"</strong>, <strong>\"Â¿CÃ³mo subo contenido?\"</strong>, <strong>\"RecomiÃ©ndame un juego de terror\"</strong>. NEXUS entiende lenguaje natural y responde al instante.",
        pos:   "left"
    },
    {
        sel:   null,
        title: "ğŸ‰ Â¡Listo, ya sabes todo!",
        body:  "Ya conoces UpGames de punta a punta. Si en algÃºn momento tienes dudas, toca el botÃ³n <strong>?</strong> en la esquina inferior izquierda para ver este tutorial de nuevo. Â¡A disfrutar!",
        pos:   "center"
    }
];

/* â”€â”€ REFS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const lockEl  = document.getElementById('btut-lock');
const spotEl  = document.getElementById('btut-spotlight');
const tipEl   = document.getElementById('btut-tooltip');
const badgeEl = document.getElementById('btut-badge');
const titleEl = document.getElementById('btut-title');
const bodyEl  = document.getElementById('btut-body');
const dotsEl  = document.getElementById('btut-dots');
const prevBtn = document.getElementById('btut-prev');
const nextBtn = document.getElementById('btut-next');
const closeB  = document.getElementById('btut-close');
const fabBtn  = document.getElementById('btut-fab');

let idx    = 0;
let active = false;
let lastEl = null;

/* â”€â”€ API PÃšBLICA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
window.startBibliotecaTutorial = start;

function start() {
    idx    = 0;
    active = true;
    lockEl.classList.add('on');
    spotEl.style.display = 'block';
    tipEl.style.display  = 'block';
    document.body.style.overflow = 'hidden';
    render();
}

function finish() {
    active = false;
    lockEl.classList.remove('on');
    spotEl.style.display = 'none';
    tipEl.style.display  = 'none';
    document.body.style.overflow = '';
    clearPulse();
    localStorage.setItem('upgames_onboarding_done', '1');
}

/* â”€â”€ RENDER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function render() {
    const s = STEPS[idx];
    const total = STEPS.length;

    /* Contenido */
    badgeEl.textContent = `Tutorial Â· ${idx + 1}/${total}`;
    titleEl.textContent  = s.title;
    bodyEl.innerHTML     = s.body;

    /* Dots */
    dotsEl.innerHTML = '';
    STEPS.forEach((_, i) => {
        const d = document.createElement('span');
        d.className = 'btut-dot' + (i === idx ? ' on' : '');
        dotsEl.appendChild(d);
    });

    /* Botones */
    prevBtn.style.visibility = idx === 0 ? 'hidden' : 'visible';
    nextBtn.textContent = idx === total - 1 ? 'Finalizar âœ“' : 'Siguiente â†’';

    /* Limpiar highlight anterior */
    clearPulse();

    if (s.pos === 'center' || !s.sel) {
        hideSpot();
        placeCenter();
    } else {
        const el = document.querySelector(s.sel);
        if (!el) { hideSpot(); placeCenter(); }
        else      { spotOn(el, s); }
    }

    /* AnimaciÃ³n */
    tipEl.classList.remove('btut-in');
    void tipEl.offsetWidth;
    tipEl.classList.add('btut-in');
}

function spotOn(el, s) {
    const PAD  = 8;
    const rect = el.getBoundingClientRect();

    spotEl.style.top    = (rect.top  - PAD) + 'px';
    spotEl.style.left   = (rect.left - PAD) + 'px';
    spotEl.style.width  = (rect.width  + PAD * 2) + 'px';
    spotEl.style.height = (rect.height + PAD * 2) + 'px';
    spotEl.style.display = 'block';

    el.classList.add('btut-pulse');
    lastEl = el;

    placeTooltip(rect, s.pos);
}

function hideSpot() {
    spotEl.style.display = 'none';
}

function clearPulse() {
    if (lastEl) { lastEl.classList.remove('btut-pulse'); lastEl = null; }
}

/* â”€â”€ POSICIONAMIENTO DEL TOOLTIP (Mobile-first) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function placeCenter() {
    tipEl.className = 'btut-tooltip arr-none';
    tipEl.style.transform = 'translate(-50%, -50%)';
    tipEl.style.top  = '50%';
    tipEl.style.left = '50%';
}

function placeTooltip(rect, pos) {
    const isMobile = window.innerWidth <= 600;
    const TW = tipEl.offsetWidth  || 310;
    const TH = tipEl.offsetHeight || 230;
    const VW = window.innerWidth;
    const VH = window.innerHeight;
    const GAP = 14;

    tipEl.style.transform = '';

    let top, left, arrClass = 'arr-top';

    if (isMobile) {
        /* En mobile: tooltip siempre centrado horizontalmente,
           colocado en la mitad inferior si hay espacio,
           o superior si el elemento estÃ¡ muy abajo */
        left = 10;
        const spaceBelow = VH - rect.bottom;
        const spaceAbove = rect.top;

        if (spaceBelow >= TH + GAP + 20) {
            top = rect.bottom + GAP;
            arrClass = 'arr-top';
        } else if (spaceAbove >= TH + GAP + 20) {
            top = rect.top - TH - GAP;
            arrClass = 'arr-bottom';
        } else {
            /* Sin espacio ni arriba ni abajo: poner en zona segura */
            top = VH * 0.55;
            arrClass = 'arr-none';
        }
    } else {
        /* Desktop: posicionamiento inteligente */
        if (pos === 'below' || pos === 'header-b') {
            top  = rect.bottom + GAP;
            left = Math.max(10, rect.left);
            arrClass = 'arr-top';
        } else if (pos === 'above') {
            top  = rect.top - TH - GAP;
            left = Math.max(10, rect.left);
            arrClass = 'arr-bottom';
        } else if (pos === 'left') {
            top  = Math.max(10, rect.top);
            left = rect.left - TW - GAP;
            arrClass = 'arr-right';
            if (left < 10) { left = rect.right + GAP; arrClass = 'arr-left'; }
        }

        /* Evitar salir por la derecha */
        if (left + TW > VW - 10) left = VW - TW - 10;
        if (left < 10) left = 10;

        /* Evitar salir por abajo */
        if (top + TH > VH - 10) {
            top = rect.top - TH - GAP;
            arrClass = 'arr-bottom';
        }
        if (top < 10) top = 10;
    }

    tipEl.className = `btut-tooltip ${arrClass}`;
    tipEl.style.top  = top + 'px';
    tipEl.style.left = left + 'px';
}

/* â”€â”€ EVENTOS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
nextBtn.addEventListener('click', () => {
    if (idx < STEPS.length - 1) { idx++; render(); }
    else finish();
});
prevBtn.addEventListener('click', () => {
    if (idx > 0) { idx--; render(); }
});
closeB.addEventListener('click', finish);
fabBtn.addEventListener('click', start);

/* Bloquear cualquier toque/click en el overlay de bloqueo */
lockEl.addEventListener('click',      e => e.stopPropagation(), true);
lockEl.addEventListener('touchstart', e => e.preventDefault(),  { passive: false });
lockEl.addEventListener('touchmove',  e => e.preventDefault(),  { passive: false });

/* Teclas de navegaciÃ³n en desktop */
document.addEventListener('keydown', e => {
    if (!active) return;
    if (e.key === 'ArrowRight' || e.key === 'Enter') nextBtn.click();
    if (e.key === 'ArrowLeft')  prevBtn.click();
    if (e.key === 'Escape')     finish();
});

/* Recalcular si rota el dispositivo */
window.addEventListener('resize', () => { if (active) render(); });

})();
</script>
<!-- FIN TUTORIAL BIBLIOTECA v2 -->

    
</body>
</html>
